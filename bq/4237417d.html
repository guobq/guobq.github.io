<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="mysql安装及使用"><meta name="keywords" content="mysql"><meta name="author" content="bq,undefined"><meta name="copyright" content="bq"><title>mysql安装及使用【bq's notes】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"8ICB0LL54F","apiKey":"b6e01221a0e1bdb34d69e088b9bd39d8","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {},
  valine: {"appId":"8xUuEcUoXahLwm69LVK1eumF-gzGzoHsz","appKey":"NDF5dcJsxuEHHBOLlda7Y07b"},
}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="bq's notes" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E4%B8%8E%E8%B5%8B%E6%9D%83"><span class="toc-number">1.1.</span> <span class="toc-text">添加用户与赋权</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E8%AF%B4%E6%98%8E"><span class="toc-number">1.2.</span> <span class="toc-text">权限说明</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DDl"><span class="toc-number">3.</span> <span class="toc-text">DDl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DML"><span class="toc-number">4.</span> <span class="toc-text">DML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.</span> <span class="toc-text">简单查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">聚合函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E7%AD%9B%E9%80%89"><span class="toc-number">5.2.</span> <span class="toc-text">分组筛选</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E6%8E%A5"><span class="toc-number">6.</span> <span class="toc-text">多表联接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D"><span class="toc-number">7.</span> <span class="toc-text">备份恢复</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">8.</span> <span class="toc-text">存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%EF%BC%8C%E6%85%A2%E6%9F%A5%E8%AF%A2"><span class="toc-number">9.</span> <span class="toc-text">索引，慢查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">10.</span> <span class="toc-text">存储引擎</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">bq</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/guobq" target="_blank">GitHub<i class="icon-dot bg-color9"></i></a><a class="links-button button-hover" href="mailto:2278220079@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color5"></i></a><a class="links-button button-hover" href="http://wpa.qq.com/msgrd?v=3&amp;uin=2278220079&amp;site=qq&amp;menu=yes" target="_blank">QQ<i class="icon-dot bg-color7"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">73</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">73</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">25</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">bq's notes</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">mysql安装及使用</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2018-08-13 | 更新于 2021-06-03</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E5%B7%A5%E5%85%B7/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/mysql/">mysql</a></div></div></div><div class="main-content"><h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql -v ~/docker/mysql:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d -p 13306:3306 mysql:5.7</span><br><span class="line"></span><br><span class="line">docker exec -it mysql bash</span><br><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>

<h5 id="添加用户与赋权"><a href="#添加用户与赋权" class="headerlink" title="添加用户与赋权"></a>添加用户与赋权</h5><p>创建用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="comment">--username – 你将创建的用户名说明:</span></span><br><span class="line"><span class="comment">--host – 指定该用户在哪个主机上可以登陆,如果是本地用户可用localhost,  如 果想让该用户可以从任意远程主机登陆,可以使用通配符%</span></span><br><span class="line"><span class="comment">--password –  该用户的登陆密码,密码可以为空,如果为空则该用户可以不需要密码登 陆服务</span></span><br></pre></td></tr></table></figure>
<p>授权</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">privileges</span> <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br><span class="line"><span class="comment">--privileges – 用户的操作权限,如SELECT , INSERT , UPDATE  等(详细列表见该文最后面).如果要授予所有的权限则使用ALL说明: </span></span><br><span class="line"><span class="comment">--databasename –  数据库名</span></span><br><span class="line"><span class="comment">--tablename-表名,如果要授予该用户对所有数据库和表的相应操作权限则可用* 表示, 如*.*</span></span><br></pre></td></tr></table></figure>
<p>设置与更改用户密码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> = <span class="keyword">PASSWORD</span>(<span class="string">&#x27;newpassword&#x27;</span>);</span><br><span class="line"><span class="comment">--如果是当前登陆用户用</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> = <span class="keyword">PASSWORD</span>(<span class="string">&quot;newpassword&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>撤销用户权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> databasename.tablename <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>删除用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> ‘username’@<span class="string">&#x27;host’;</span></span><br></pre></td></tr></table></figure>
<p>权限刷新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure>
<p>example:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进⼊mysql</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> use mysql;</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> update user <span class="built_in">set</span> authentication_string = password(<span class="string">&#x27;123456&#x27;</span>) <span class="built_in">where</span> user =</span></span><br><span class="line">‘root’; #修改root密码</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> GRANT ALL PRIVILEGES ON *.* TO <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED BY <span class="string">&#x27;root&#x27;</span></span></span><br><span class="line">WITH GRANT OPTION; #添加权限</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加用户</span></span><br><span class="line">create user test identified by &#x27;test&#x27;;</span><br><span class="line">create database  testdb;</span><br><span class="line">grant all privileges on testdb.* to test@&#x27;%&#x27; identified by &#x27;test&#x27;;</span><br><span class="line">flush privileges;</span><br><span class="line">select user,host from mysql.user;</span><br><span class="line">show grants for test;</span><br><span class="line">show variables like &#x27;validate_password%&#x27;;</span><br></pre></td></tr></table></figure>

<h5 id="权限说明"><a href="#权限说明" class="headerlink" title="权限说明"></a>权限说明</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">ALTER : Allows use of ALTER TABLE. </span><br><span class="line">ALTER ROUTINE : Alters or drops stored routines. </span><br><span class="line">CREATE : Allows use of CREATE TABLE. </span><br><span class="line">CREATE ROUTINE : Creates stored routines. </span><br><span class="line">CREATE TEMPORARY TABLE : Allows use of CREATE TEMPORARY TABLE. </span><br><span class="line">CREATE USER : Allows use of CREATE USER, DROP USER, RENAME USER, and REVOKE ALL PRIVILEGES. </span><br><span class="line">CREATE VIEW : Allows use of CREATE VIEW. </span><br><span class="line">DELETE : Allows use of DELETE. </span><br><span class="line">DROP : Allows use of DROP TABLE. </span><br><span class="line">EXECUTE : Allows the user to run stored routines. </span><br><span class="line">FILE : Allows use of SELECT… INTO OUTFILE and LOAD DATA INFILE. </span><br><span class="line">INDEX : Allows use of CREATE INDEX and DROP INDEX. </span><br><span class="line">INSERT : Allows use of INSERT. </span><br><span class="line">LOCK TABLES : Allows use of LOCK TABLES on tables for which the user also has SELECT privileges. </span><br><span class="line">PROCESS : Allows use of SHOW FULL PROCESSLIST. </span><br><span class="line">RELOAD : Allows use of FLUSH. </span><br><span class="line">REPLICATION : Allows the user to ask where slave or master </span><br><span class="line">CLIENT : servers are. </span><br><span class="line">REPLICATION SLAVE : Needed for replication slaves. </span><br><span class="line">SELECT : Allows use of SELECT. </span><br><span class="line">SHOW DATABASES : Allows use of SHOW DATABASES. </span><br><span class="line">SHOW VIEW : Allows use of SHOW CREATE VIEW. </span><br><span class="line">SHUTDOWN : Allows use of mysqladmin shutdown. </span><br><span class="line">SUPER : Allows use of CHANGE MASTER, KILL, PURGE MASTER LOGS, and SET GLOBAL SQL statements. Allows mysqladmin debug command. Allows one extra connection to be made if maximum connections are reached. </span><br><span class="line">UPDATE : Allows use of UPDATE. </span><br><span class="line">USAGE : Allows connection without any specific privileges.</span><br></pre></td></tr></table></figure>

<h4 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h4><ol>
<li>数值数据类型<br>整数类型： TINYINT、SMALLINT、MEDIUMINT、INT、<br>BIGINT<br>浮点数类型：FLOAT、DOUBLE<br>定点⼩数： DECIMAL</li>
<li>⽇期/时间类型<br>YEAR、TIME、DATE、DATETIME、TIMESTAMP</li>
<li>字符串类型，其中字符串又可以分为⽂本字符串和⼆进制字符串<br>⽂本字符串：<br>CHAR、VARCHAR、TEXT、ENUM、SET等　<br>⼆进制字符串<br>BIT、BINARY、VARBINARY、BLOB</li>
</ol>
<h4 id="DDl"><a href="#DDl" class="headerlink" title="DDl"></a>DDl</h4><p>定义数据库对象：库、表、列列（Create，Drop，Alter，Show，Rename）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &#96;users&#96; (</span><br><span class="line">&#96;empno&#96; int(10) NOT NULL,</span><br><span class="line">&#96;name&#96; varchar(50) NOT NULL,</span><br><span class="line">&#96;birth&#96; date DEFAULT NULL,</span><br><span class="line">&#96;sex&#96; char(1) DEFAULT NULL,</span><br><span class="line">&#96;salary&#96; decimal(8,2) DEFAULT NULL,</span><br><span class="line">&#96;regtime&#96; datetime DEFAULT</span><br><span class="line">CURRENT_TIMESTAMP,</span><br><span class="line">PRIMARY KEY (&#96;empno&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB DEFAULT</span><br><span class="line">CHARSET&#x3D;utf8;</span><br><span class="line"># 修改表字段类型</span><br><span class="line">ALTER TABLE users MODIFY age date ;</span><br><span class="line"># 修改字段名和类型</span><br><span class="line">ALTER TABLE users change age birthday date ;</span><br><span class="line">SHOW TABLES;</span><br><span class="line"># 重命名表</span><br><span class="line">RENAME TABLE users TO pay_users;</span><br><span class="line"># 删除表</span><br><span class="line">DROP TABLE IF EXISTS users;</span><br><span class="line"># 删除所有信息</span><br><span class="line">TRUNCATE users;</span><br></pre></td></tr></table></figure>

<h4 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h4><p>数据操作，增、删、改、查数据库记录(insert,delete,update)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 插⼊单条数据</span><br><span class="line">INSERT INTO tbl_name (col1,col2) VALUES (value1,value2);</span><br><span class="line"># 删除数据</span><br><span class="line">DELETE FROM tbl_name;</span><br><span class="line"># 更新数据</span><br><span class="line">update users1 set birth &#x3D;&#39;1989-01-31&#39; where name&#x3D;‘fang&#39;</span><br></pre></td></tr></table></figure>

<h4 id="简单查询"><a href="#简单查询" class="headerlink" title="简单查询"></a>简单查询</h4><p>1.选择所有数据<br>2.选择特定⾏<br>3.选择特定列<br>4.排序⾏<br>5.模糊查询<br>6.⽇期函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.精确查询：&#x3D; &lt;&gt;</span><br><span class="line">2.别名：as</span><br><span class="line">3.限制⾏：limit m,n</span><br><span class="line">4.⽐较运算符：&gt;,&gt;&#x3D;,&lt;,&lt;&#x3D;</span><br><span class="line">5.逻辑运算符：and 两条件同时满⾜，or⼀个条件满⾜就⾏ and优先级⾼于or</span><br><span class="line">6.去重 distinct</span><br><span class="line">7.区间运算</span><br><span class="line">8.排序 order by desc降序，asc 升序</span><br><span class="line">9.模糊查询：like % _ notlike</span><br><span class="line">10.集合运算 in , not in</span><br><span class="line">11.⾮空运算 is null,is not null</span><br></pre></td></tr></table></figure>

<h5 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h5><p>count,sum，avg,max,min</p>
<h5 id="分组筛选"><a href="#分组筛选" class="headerlink" title="分组筛选"></a>分组筛选</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT &lt;列列名&gt;</span><br><span class="line">FROM &lt;表名&gt;</span><br><span class="line">[WHERE &lt;查询表达式&gt;]</span><br><span class="line">[GROUP BY &lt;分组列列名&gt;]</span><br><span class="line">[HAVING &lt;分组后的查询表达式&gt;]</span><br></pre></td></tr></table></figure>

<p>WHERE⼦子句句从数据源中去掉不不符合其搜索条件的数据<br>GROUP BY⼦子句句搜集数据⾏行行到各个组中，统计函数为各个组计算统计值<br>HAVING⼦子句句去掉不不符合其组搜索条件的各组数据⾏</p>
<h4 id="多表联接"><a href="#多表联接" class="headerlink" title="多表联接"></a>多表联接</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># WHERE（等值连接）</span><br><span class="line">select 列名 from 表A a ,表B b where a.key&#x3D;b.key</span><br><span class="line"># 内联接(INNER JOIN)</span><br><span class="line">select 列列名 from 表A a inner join 表B b on a.key&#x3D;b.key</span><br><span class="line"># 外联接(OUTER JOIN)</span><br><span class="line"># 左外联接： </span><br><span class="line">select 列名 from 表A a left join 表B b on a.key&#x3D;b.key</span><br><span class="line"># 右外联接：</span><br><span class="line">select 列名 from 表A a right join 表B b on a.key&#x3D;b.key</span><br><span class="line"># CROSS JOIN(笛卡尔积):</span><br><span class="line">SELECT t1.id, t2.id FROM t1 CROSS JOIN t2;</span><br><span class="line"># Union :</span><br><span class="line">SELECT * FROM t1 union select * from t2;</span><br></pre></td></tr></table></figure>

<h4 id="备份恢复"><a href="#备份恢复" class="headerlink" title="备份恢复"></a>备份恢复</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -help</span><br><span class="line"># 备份：</span><br><span class="line">mysqldump -u ⽤户名 -p --databases db &gt; 备份⽂件名.sql</span><br><span class="line"># 恢复：</span><br><span class="line">通过mysqldump备份的⽂件，如果⽤了--all-databases或--databases选项，则在备份⽂件中包含 CREATE DATABASE和 USE语句，不需要指定⼀个数据库名去恢复备份⽂件。</span><br><span class="line">shell&gt; mysql –u ⽤户名 –p &lt; 备份⽂件.sql</span><br><span class="line">mysql&gt; source备份⽂件.sql;</span><br><span class="line">如果通过mysqldump备份的是单个数据库，且没有使⽤--databases选项，则备份⽂件中不包含 CREATE DATABASE和 USE语句，那么在恢复的时候必须先创建数据库。</span><br></pre></td></tr></table></figure>

<h4 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 删除存储过程，如果这个名字的已存在</span><br><span class="line">DROP PROCEDURE if exists insert_data_pro;</span><br><span class="line"># 由于语句较多，使⽤这个告诉mysql，看看$$就表⽰语句结束了。</span><br><span class="line">DELIMITER $$</span><br><span class="line"># 建⽴存储过程名字叫 insert_data_pro</span><br><span class="line">CREATE</span><br><span class="line">PROCEDURE insert_data_pro()</span><br><span class="line">BEGIN # 开始</span><br><span class="line">DECLARE i INT; #定义 i</span><br><span class="line">SET i&#x3D;0; # 设置初始值为0</span><br><span class="line">WHILE i&gt;&#x3D;0 &amp;&amp; i&lt;&#x3D; 10000 DO # 循环 插⼊10000条数据，可以变化。</span><br><span class="line">INSERT INTO</span><br><span class="line">big_data(name1,age,email)values(concat(‘bq’,i),rand()*50,concat(&#39;bq&#39;,i,&#39;@qq.com&#39;));</span><br><span class="line"># 写的sql，concat是将多个str连在⼀起。</span><br><span class="line">SET i&#x3D;i + 1;</span><br><span class="line">END WHILE; #结束循环</span><br><span class="line">END$$ #存储过程结束</span><br><span class="line">DELIMITER ; #恢复设置</span><br><span class="line"># 下⾯是调⽤存储过程</span><br><span class="line">call insert_data_pro();</span><br></pre></td></tr></table></figure>

<h4 id="索引，慢查询"><a href="#索引，慢查询" class="headerlink" title="索引，慢查询"></a>索引，慢查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX index_name ON big_data(name);</span><br><span class="line">explain + 查询SQL - ⽤于显⽰SQL执⾏信息参数</span><br><span class="line"># MySQL Explain详解 https:&#x2F;&#x2F;www.cnblogs.com&#x2F;tufujie&#x2F;p&#x2F;9413852.html</span><br></pre></td></tr></table></figure>

<h4 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">show ENGINES;</span><br><span class="line"># InnoDB：MySQL 5.7中的默认存储引擎。 InnoDB是⼀种适⽤于MySQL的事务安全（ACID兼容）存储引擎，具有提交，回滚和崩溃恢复功能，可保护⽤户数据。 InnoDB⾏级锁定（没有升级到更粗略的粒度锁）和Oracle风格的⼀致⾮锁定读取增加了多⽤户并发性和性能。InnoDB将⽤户数据存储在聚簇索引中，以减少基于主键的常见查询的I &#x2F; O. 为了保持数据完整性， InnoDB还⽀持FOREIGN KEY参照完整性约束。</span><br><span class="line"># MyISAM：这些表占⽤空间⼩。 表级锁定 限制了读&#x2F;写⼯作负载的性能，因此它通常⽤于Web和数据仓库配置中的只读或⼤部分读取⼯作负载。</span><br><span class="line"># Memory：将所有数据存储在RAM中，以便在需要快速查找⾮关键数据的环境中快速访问。这台发动机以前被称为HEAP发动机。它的⽤例正在减少; InnoDB其缓冲池存储区提供了⼀种通⽤且持久的⽅式来将⼤部分或全部数据保存在内存中，并 NDBCLUSTER为⼤型分布式数据集提供快速键值查找。</span><br><span class="line"># CSV：它的表实际上是以逗号分隔值的⽂本⽂件。CSV表允许您以CSV格式导⼊或转储数据，以便与读取和写⼊相同格式的脚本和应⽤程序交换数据。由于CSV表未编制索引，因此通常InnoDB在正常操作期间将数据保留在表中，并且仅在导⼊或导出阶段使⽤CSV表。</span><br><span class="line"># Archive：这些紧凑的⽆索引表⽤于存储和检索⼤量很少引⽤的历史，存档或安全审计信息。</span><br><span class="line"># Blackhole：Blackhole存储引擎接受但不存储数据</span><br><span class="line"># NDB（也称为 NDBCLUSTER） - 该集群数据库引擎特别适⽤于需要尽可能⾼的正常运⾏时间和可⽤性的应⽤程序</span><br><span class="line"># Merge：适⽤于数据仓库等VLDB环境。</span><br><span class="line"># Federated：提供链接单独的MySQL服务器以从许多物理服务器创建⼀个逻辑数据库的功能。⾮常适合分布式或数据集市环境。</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM employees </span><br><span class="line">LIMIT 100;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM employees </span><br><span class="line">WHERE last_name&#x3D;&#39;Facello&#39;;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM employees </span><br><span class="line">WHERE last_name&lt;&gt;&#39;Facello&#39; and emp_no&lt;10020;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE hire_date&gt;&#39;2000-01-01&#39;;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM employees t </span><br><span class="line">WHERE t.gender&#x3D;&#39;M&#39; AND t.last_name&#x3D;&#39;Pettey&#39;;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM employees t </span><br><span class="line">WHERE t.gender&#x3D;&#39;M&#39; AND t.last_name&#x3D;&#39;Pettey&#39; or t.gender&#x3D;&#39;M&#39; AND t.last_name&#x3D;&#39;Hutton&#39;;</span><br><span class="line"></span><br><span class="line">SELECT DISTINCT (last_name) </span><br><span class="line">FROM employees t </span><br><span class="line">ORDER BY t.last_name DESC; </span><br><span class="line"></span><br><span class="line">SELECT last_name,hire_date </span><br><span class="line">FROM employees </span><br><span class="line">WHERE hire_date&gt;&#x3D;&#39;2000&#39; </span><br><span class="line">ORDER BY hire_date DESC ,last_name ASC;</span><br><span class="line"></span><br><span class="line">SELECT last_name,hire_date </span><br><span class="line">FROM employees </span><br><span class="line">WHERE last_name NOT IN (&#39;Facello&#39;,&#39;Hutton&#39;);</span><br><span class="line"></span><br><span class="line">SELECT last_name,hire_date </span><br><span class="line">FROM employees </span><br><span class="line">WHERE last_name IN (&#39;Facello&#39;,&#39;Hutton&#39;);</span><br><span class="line"></span><br><span class="line">SELECT last_name,hire_date </span><br><span class="line">FROM employees </span><br><span class="line">WHERE hire_date is NULL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT EXTRACT(YEAR FROM CURDATE());</span><br><span class="line"></span><br><span class="line">SELECT last_name,EXTRACT(YEAR FROM CURDATE()),EXTRACT(YEAR FROM hire_date) </span><br><span class="line">FROM employees </span><br><span class="line">WHERE EXTRACT(YEAR FROM CURDATE())-EXTRACT(YEAR FROM hire_date)&gt;20;</span><br><span class="line"></span><br><span class="line">SELECT last_name,hire_date </span><br><span class="line">FROM employees </span><br><span class="line">WHERE hire_date&lt;DATE_SUB(CURDATE(),INTERVAL 20 YEAR);</span><br><span class="line"></span><br><span class="line">SELECT DISTINCT(emp_no) </span><br><span class="line">FROM salaries </span><br><span class="line">WHERE salary BETWEEN 20000 AND 50000;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees</span><br><span class="line">WHERE first_name LIKE &#39;b%&#39;;</span><br><span class="line"> </span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name REGEXP &#39;^b&#39;;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name LIKE &#39;%nd&#39;;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name REGEXP &#39;nd$&#39;;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name LIKE &#39;%we%&#39;;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name REGEXP &#39;we&#39;;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name LIKE &#39;_____&#39;;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE LENGTH(first_name)&#x3D;5;</span><br><span class="line"></span><br><span class="line">SELECT last_name 姓,first_name 名 </span><br><span class="line">FROM employees </span><br><span class="line">WHERE first_name REGEXP &#39;^.....$&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT COUNT(salary) </span><br><span class="line">FROM salaries </span><br><span class="line">WHERE emp_no&#x3D;10001;</span><br><span class="line"></span><br><span class="line">SELECT SUM(salary) </span><br><span class="line">FROM salaries </span><br><span class="line">WHERE emp_no&#x3D;10001;</span><br><span class="line"></span><br><span class="line">SELECT MAX(salary) </span><br><span class="line">FROM salaries </span><br><span class="line">WHERE emp_no&#x3D;10001;</span><br><span class="line"></span><br><span class="line">SELECT MIN(salary) </span><br><span class="line">FROM salaries </span><br><span class="line">WHERE emp_no&#x3D;10001;</span><br><span class="line"></span><br><span class="line">SELECT ROUND(AVG(salary),2) </span><br><span class="line">FROM salaries </span><br><span class="line">WHERE emp_no&#x3D;10001;</span><br><span class="line"></span><br><span class="line">SELECT MAX(hire_date),gender </span><br><span class="line">FROM employees </span><br><span class="line">GROUP BY gender;</span><br><span class="line"></span><br><span class="line">SELECT emp_no,AVG(salary) 平均薪资,MAX(salary) 最高薪资,MIN(salary) 最低薪资 </span><br><span class="line">FROM salaries </span><br><span class="line">GROUP BY emp_no;</span><br><span class="line"></span><br><span class="line">SELECT emp_no </span><br><span class="line">FROM dept_emp </span><br><span class="line">GROUP BY emp_no </span><br><span class="line">HAVING COUNT(emp_no)&gt;1;</span><br><span class="line"></span><br><span class="line">SELECT * FROM employees </span><br><span class="line">WHERE emp_no in(</span><br><span class="line">SELECT emp_no FROM dept_emp </span><br><span class="line">GROUP BY emp_no </span><br><span class="line">HAVING COUNT(emp_no)&gt;1);</span><br><span class="line"></span><br><span class="line">SELECT * FROM employees </span><br><span class="line">WHERE emp_no&#x3D;(</span><br><span class="line">SELECT emp_no FROM salaries </span><br><span class="line">WHERE to_date&#x3D;&#39;9999-01-01&#39; </span><br><span class="line">ORDER BY salary DESC LIMIT 1);</span><br><span class="line"></span><br><span class="line">SELECT * FROM salaries </span><br><span class="line">WHERE emp_no in(</span><br><span class="line">SELECT emp_no FROM salaries </span><br><span class="line">GROUP BY emp_no HAVING COUNT(emp_no)&gt;&#x3D;18);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT a.emp_no,a.first_name,b.dept_no </span><br><span class="line">FROM employees a,dept_emp b </span><br><span class="line">WHERE a.emp_no&#x3D;b.emp_no;</span><br><span class="line"></span><br><span class="line">SELECT a.emp_no,a.first_name,b.dept_no,c.dept_name </span><br><span class="line">FROM employees a,dept_emp b,departments c </span><br><span class="line">WHERE a.emp_no&#x3D;b.emp_no AND b.dept_no&#x3D;c.dept_no;</span><br><span class="line"></span><br><span class="line">SELECT a.emp_no,a.first_name </span><br><span class="line">FROM employees a </span><br><span class="line">INNER JOIN dept_emp b ON a.emp_no&#x3D;b.emp_no </span><br><span class="line">INNER JOIN departments c ON b.dept_no&#x3D;c.dept_no </span><br><span class="line">WHERE c.dept_name&#x3D;&#39;Customer Service&#39;</span><br><span class="line"></span><br><span class="line">SELECT COUNT(a.emp_no)</span><br><span class="line">FROM employees a </span><br><span class="line">LEFT JOIN dept_emp b ON a.emp_no&#x3D;b.emp_no </span><br><span class="line">LEFT JOIN departments c ON b.dept_no&#x3D;c.dept_no </span><br><span class="line">WHERE c.dept_name&#x3D;&#39;Customer Service&#39;</span><br><span class="line"></span><br><span class="line">SELECT COUNT(a.emp_no) </span><br><span class="line">FROM employees a </span><br><span class="line">RIGHT JOIN dept_emp b ON a.emp_no&#x3D;b.emp_no </span><br><span class="line">RIGHT JOIN departments c ON b.dept_no&#x3D;c.dept_no </span><br><span class="line">WHERE c.dept_name&#x3D;&#39;Customer Service&#39;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM departments UNION ALL</span><br><span class="line">SELECT * FROM departments ORDER BY dept_no;</span><br><span class="line"></span><br><span class="line">SELECT emp_no,MD5(salary) 薪水保密</span><br><span class="line">FROM salaries WHERE to_date&#x3D;&#39;9999-01-01&#39;</span><br><span class="line">ORDER BY salary ASC LIMIT 10;</span><br><span class="line"></span><br><span class="line">SELECT emp_no,MD5(salary) 薪水保密</span><br><span class="line">FROM salaries WHERE to_date&#x3D;&#39;9999-01-01&#39;</span><br><span class="line">ORDER BY salary ASC LIMIT 10;</span><br><span class="line"></span><br><span class="line">SELECT emp_no,MD5(salary) 薪水保密</span><br><span class="line">FROM salaries WHERE to_date&gt;CURDATE()</span><br><span class="line">ORDER BY salary  LIMIT 10;</span><br><span class="line"></span><br><span class="line">UPDATE salaries SET salary&#x3D;salary+3000 </span><br><span class="line">WHERE emp_no IN(</span><br><span class="line">SELECT DISTINCT(emp_no) FROM dept_emp</span><br><span class="line">WHERE EXTRACT(YEAR FROM from_date)&#x3D;2002</span><br><span class="line">AND to_date&gt;CURDATE()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE &#96;testdata&#96;(</span><br><span class="line">&#96;id&#96; int(10) UNSIGNED NOT NULL AUTO_INCREMENT,</span><br><span class="line">&#96;payload&#96; json DEFAULT NULL,</span><br><span class="line">&#96;response&#96; json DEFAULT NULL,</span><br><span class="line">PRIMARY KEY(&#96;id&#96;)</span><br><span class="line">) ENGINE&#x3D;INNODB DEFAULT CHARSET&#x3D;utf8;</span><br><span class="line">DESC testdata;</span><br><span class="line"></span><br><span class="line">INSERT INTO testdata (payload,response)</span><br><span class="line">VALUES(&#39;&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;test&quot;&#125;&#39;,&#39;&#123;&quot;code&quot;:40000,&quot;msg&quot;:&quot;ok&quot;&#125;&#39;);</span><br><span class="line"></span><br><span class="line">INSERT INTO testdata (payload,response)</span><br><span class="line">VALUES(JSON_OBJECT(&quot;id&quot;,3,&quot;name&quot;,&quot;dev1&quot;),</span><br><span class="line">JSON_ARRAY(1,3,5));</span><br><span class="line"></span><br><span class="line">SELECT id,payload-&gt;&#39;$.id&#39;,payload-&gt;&#39;$.name&#39;,response-&gt;&#39;$[0]&#39;,response-&gt;&#39;$[2]&#39; FROM testdata;</span><br><span class="line"></span><br><span class="line">SELECT * FROM testdata WHERE payload-&gt;&#39;$.name&#39;&#x3D;&#39;test&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">存储过程</span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS big_data;</span><br><span class="line"></span><br><span class="line">CREATE TABLE big_data(</span><br><span class="line">id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,</span><br><span class="line">name1 VARCHAR(16) DEFAULT NULL,</span><br><span class="line">age INT(11),</span><br><span class="line">email VARCHAR(64) DEFAULT NULL</span><br><span class="line">)ENGINE&#x3D;MYISAM DEFAULT CHARSET&#x3D;utf8;</span><br><span class="line"></span><br><span class="line">DROP PROCEDURE if exists insert_data_pro;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">CREATE</span><br><span class="line">PROCEDURE insert_data_pro()</span><br><span class="line">BEGIN </span><br><span class="line">DECLARE i INT; </span><br><span class="line">SET i&#x3D;0; </span><br><span class="line">WHILE i&gt;&#x3D;0 &amp;&amp; i&lt;&#x3D; 10000 DO </span><br><span class="line">INSERT INTO</span><br><span class="line">big_data(name1,age,email)values(concat(&#39;test&#39;,i),rand()*50,concat(&#39;test&#39;,i,&#39;@qq.com&#39;));</span><br><span class="line">SET i&#x3D;i + 1;</span><br><span class="line">END WHILE; </span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">call insert_data_pro();</span><br><span class="line"></span><br><span class="line">ALTER TABLE big_data ENGINE&#x3D;INNODB;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">bq</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://guobq.github.io/bq/4237417d.html">https://guobq.github.io/bq/4237417d.html</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://guobq.github.io">bq's notes</a>！</span></div></div><div class="post-copyright valine" id="comments-container"><script src="//unpkg.com/valine@1.4.14/dist/Valine.min.js"></script><script>let arr = location.href.split('/#more')[0].split('/');
let title = arr[arr.length - 1];
if (title === '') {
    title = arr[arr.length - 2];
}
var flag = false;
var gitFun = function () {
    try {
        var valineObj = window.GLOBAL_CONFIG.valine;
        new Valine({
            el: "#comments-container",
            ...valineObj
        });
        flag = true;
    } catch (e) {
        flag = false;
    }
}
var setIn = setInterval(() => {
    if (!flag) {
        gitFun();
    } else {
        clearInterval(setIn);
    }
}, 200);</script></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/bq/9ac2dadd.html"><i class="fas fa-angle-left">&nbsp;</i><span>数据库权限</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/bq/811c2840.html"><span>Spring Boot 打包</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2020 ～ 2021 By bq</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>