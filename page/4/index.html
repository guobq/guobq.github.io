<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords"><meta name="author" content="bq,undefined"><meta name="copyright" content="bq"><title>【bq's notes】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"8ICB0LL54F","apiKey":"b6e01221a0e1bdb34d69e088b9bd39d8","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {},
  valine: {"appId":"8xUuEcUoXahLwm69LVK1eumF-gzGzoHsz","appKey":"NDF5dcJsxuEHHBOLlda7Y07b"},
}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="bq's notes" type="application/atom+xml">
</head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="author-info"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">bq</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/guobq" target="_blank">GitHub<i class="icon-dot bg-color10"></i></a><a class="links-button button-hover" href="mailto:2278220079@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color7"></i></a><a class="links-button button-hover" href="http://wpa.qq.com/msgrd?v=3&amp;uin=2278220079&amp;site=qq&amp;menu=yes" target="_blank">QQ<i class="icon-dot bg-color9"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">78</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">80</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">25</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">bq's notes</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><div id="recent-posts"><!-- each post in page.posts.sort('date', -1).limit(10).toArray()--><!-- config中配置按照什么排序--><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/16156a32.html">PageObject模式</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-02-04</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/automation/">automation</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/PageObject/">PageObject</a></div></div><div class="post-content"><div class="main-content content"><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>⽤Page Object表⽰UI,减少重复样板代码,让变更范围控制在Object内,本质是⾯向抽象编程</p>
<h3 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h3><h4 id="⽅法意义"><a href="#⽅法意义" class="headerlink" title="⽅法意义"></a>⽅法意义</h4><p>⽤公共⽅法代表UI所提供的功能<br>⽅法应该返回其他的PageObject或者返回⽤于断⾔的数据<br>同样的⾏为不同的结果可以建模为不同的⽅法<br>不要在⽅法内加断⾔</p>
<h4 id="字段意义"><a href="#字段意义" class="headerlink" title="字段意义"></a>字段意义</h4><p>不要暴露页⾯内部的元素给外部<br>不需要建模UI内的所有元素</p>
<h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h3><p>Page对象：完成对页⾯的封装<br>Driver对象：完成对web、android、ios、接⼜的驱动<br>测试⽤例：调⽤Page对象实现业务并断⾔<br>数据封装：配置⽂件和数据驱动<br>Utils：其他功能封装，改进原⽣框架不⾜</p>
<h3 id="数据驱动"><a href="#数据驱动" class="headerlink" title="数据驱动"></a>数据驱动</h3><p>定位符数据驱动<br>⾏为流数据驱动<br>断⾔数据驱动<br>不要全部框架数据驱动，会丢失代码⽐较重要的重构、建模、开放的⽣态能⼒</p>
</div></div><a class="button-hover more" href="/bq/16156a32.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/e331da33.html">android常用</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2022-01-07</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/automation/">automation</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Android/">Android</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/adb/">adb</a></div></div><div class="post-content"><div class="main-content content"><h2 id="adb"><a href="#adb" class="headerlink" title="adb"></a>adb</h2><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">adb devices</span><br><span class="line">adb kill-server</span><br><span class="line">adb tcpip</span><br><span class="line">adb connect</span><br><span class="line">adb logcat</span><br><span class="line">adb bugreport</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源信息</span></span><br><span class="line">adb shell dumpsys -l</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前包名</span></span><br><span class="line">adb shell dumpsys activity </span><br><span class="line"><span class="meta">#</span><span class="bash"> app信息</span></span><br><span class="line">adb shell dumpsys activity top # 获取当前界⾯元素</span><br><span class="line">adb shell dumpsys activity activities # 获取任务列表</span><br><span class="line"><span class="meta">#</span><span class="bash"> app⼊口</span></span><br><span class="line">adb logcat |grep -i displayed</span><br><span class="line">aapt dump badging mobike.apk | grep launchable-activity</span><br><span class="line">apkanalyzer</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动应⽤</span></span><br><span class="line">adb shell am start -W -n com.xueqiu.android/.view.WelcomeActivityAlias -S</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前活动页面</span></span><br><span class="line">adb shell dumpsys activity | grep mFocusedActivity</span><br><span class="line">adb shell dumpsys activity activities|grep realActivity</span><br><span class="line">adb logcat | grep -i displayed</span><br><span class="line"><span class="meta">#</span><span class="bash"> dump当前页面信息</span></span><br><span class="line">adb shell &quot;uiautomator dump &amp;&amp; cat /sdcard/window_dump.xml&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> x浏览器主页面点击主菜单</span></span><br><span class="line">adb shell input tap $(adb shell &quot;uiautomator dump --compressed &amp;&amp; cat /sdcard/window_dump.xml&quot; | sed &#x27;s\&lt;node\^&lt;node&gt;\g&#x27; | awk &#x27;BEGIN&#123;RS=&quot;^&quot;&#125;&#123;print $0&#125;&#x27; | grep 主菜单 | awk &#x27;BEGIN&#123;FS=&quot;,|\\[|\\]&quot;&#125;&#123;print ($2+$5)/2,($3+$6)/2&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取所有的dumpsys⼦命令 </span></span><br><span class="line">dumpsys |grep -i DUMP</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取当前activity </span></span><br><span class="line">adb shell dumpsys activity top</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取activities的记录，可以获取到appium依赖的原始activity </span></span><br><span class="line">adb shell dumpsys activity activities</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取特定包基本信息 </span></span><br><span class="line">adb shell dumpsys package com.mmbox.xbrowser</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取系统通知 </span></span><br><span class="line">adb shell dumpsys notification</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获得内存信息 </span></span><br><span class="line">adb shell dumpsys meminfo com.android.settings</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取cpu信息 </span></span><br><span class="line">adb shell dumpsys cpuinfo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取gpu绘制分析 </span></span><br><span class="line">adb shell dumpsys gfxinfo com.android.settings</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取短信 </span></span><br><span class="line">adb shell dumpsys activity broadcasts | grep senderName=</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取内存信息</span></span><br><span class="line">adb shell dumpsys meminfo com.mmbox.xbrowser</span><br><span class="line"><span class="meta">#</span><span class="bash"> 一秒滑动一次</span></span><br><span class="line">while true;do adb shell input swipe 270 850 240 320 1000;done</span><br><span class="line"><span class="meta">#</span><span class="bash"> app内存占用图形化</span></span><br><span class="line">for i in $(seq 20); do adb shell dumpsys meminfo com.mmbox.xbrowser | grep &quot;Dalvik Heap&quot; | awk &#x27;&#123;print $4&#125;&#x27;; sleep 1; done | gnuplot -e &quot;set terminal dumb;plot &#x27;&lt;cat&#x27; using 1 with line&quot;</span><br></pre></td></tr></table></figure>

<h3 id="模拟器"><a href="#模拟器" class="headerlink" title="模拟器"></a>模拟器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 进⼊emulator所在⽬录</span></span><br><span class="line">emulator -list-avds</span><br><span class="line">emulator @avd</span><br><span class="line">(cd $(dirname $(which emulator));emulator</span><br><span class="line">@Nexus_6P_API_23;)</span><br></pre></td></tr></table></figure>

<h3 id="func"><a href="#func" class="headerlink" title="func"></a>func</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 点击</span></span><br><span class="line">click()&#123;</span><br><span class="line">local index=1</span><br><span class="line">[ -n &quot;$2&quot; ] &amp;&amp; index=$2</span><br><span class="line">adb shell input tap $(\</span><br><span class="line">adb shell &quot;uiautomator dump --compressed &amp;&amp; cat /sdcard/window_dump.xml&quot; \</span><br><span class="line">| sed &#x27;s\&lt;node\^&lt;node&gt;\g&#x27; \</span><br><span class="line">| awk &#x27;BEGIN&#123;RS=&quot;^&quot;&#125;&#123;print $0&#125;&#x27; \</span><br><span class="line">| grep &quot;$1&quot; \</span><br><span class="line">| sed -n &quot;$index&quot;p \</span><br><span class="line">| awk &#x27;BEGIN&#123;FS=&quot;,|\\[|\\]&quot;&#125;&#123;print ($2+$5)/2,($3+$6)/2&#125;&#x27;\</span><br><span class="line">)</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> x浏览器试验</span></span><br><span class="line">for kw in X浏览器 主菜单 历史;do click $kw;done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 输入</span></span><br><span class="line">input()&#123;</span><br><span class="line">adb shell input test $1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 滑动</span></span><br><span class="line">swipe()&#123;</span><br><span class="line">width=$(adb shell wm size | grep -oE &quot;[0-9]*&quot; | head -1)</span><br><span class="line">heigth=$(adb shell wm size | grep -oE &quot;[0-9]*&quot; | tail -1)</span><br><span class="line">adb shell input swipe $(awk &#x27;BEGIN&#123;print &#x27;$width&#x27;*&#x27;$1&#x27;&#125;&#x27;) $(awk &#x27;BEGIN&#123;print &#x27;$heigth&#x27;*&#x27;$2&#x27;&#125;&#x27;) $(awk &#x27;BEGIN&#123;print &#x27;$width&#x27;*&#x27;$3&#x27;&#125;&#x27;) $(awk &#x27;BEGIN&#123;print &#x27;$heigth&#x27;*&#x27;$4&#x27;&#125;&#x27;) 1000</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="scrcpy"><a href="#scrcpy" class="headerlink" title="scrcpy"></a>scrcpy</h2><p><a target="_blank" rel="noopener" href="https://github.com/Genymobile/scrcpy">https://github.com/Genymobile/scrcpy</a></p>
<h2 id="实体键映射"><a href="#实体键映射" class="headerlink" title="实体键映射"></a>实体键映射</h2><table>
<thead>
<tr>
<th>切换全屏模式</th>
<th><code>Ctrl</code>+<code>f</code></th>
</tr>
</thead>
<tbody><tr>
<td>将窗口大小调整为 1:1（像素完美）</td>
<td><code>Ctrl</code>+<code>g</code></td>
</tr>
<tr>
<td>调整窗口大小以删除黑色边框</td>
<td><code>Ctrl</code>+ <code>x</code>| <em>双击¹</em></td>
</tr>
<tr>
<td>点击 <code>HOME</code></td>
<td><code>Ctrl</code>+ <code>h</code>| <em>中键单击</em></td>
</tr>
<tr>
<td>点击 <code>BACK</code></td>
<td><code>Ctrl</code>+ <code>b</code>| <em>右键单击²</em></td>
</tr>
<tr>
<td>点击 <code>APP_SWITCH</code></td>
<td><code>Ctrl</code>+<code>s</code></td>
</tr>
<tr>
<td>点击 <code>MENU</code></td>
<td><code>Ctrl</code>+<code>m</code></td>
</tr>
<tr>
<td>点击 <code>VOLUME_UP</code></td>
<td><code>Ctrl</code>+ <code>↑</code> <em>（向上）</em></td>
</tr>
<tr>
<td>点击 <code>VOLUME_DOWN</code></td>
<td><code>Ctrl</code>+ <code>↓</code> <em>（下）</em></td>
</tr>
<tr>
<td>点击 <code>POWER</code></td>
<td><code>Ctrl</code>+<code>p</code></td>
</tr>
<tr>
<td>打开屏幕</td>
<td><em>右键单击²</em></td>
</tr>
<tr>
<td>将计算机剪贴板粘贴到设备</td>
<td><code>Ctrl</code>+<code>v</code></td>
</tr>
<tr>
<td>启用/禁用 FPS 计数器（在标准输出上）</td>
<td><code>Ctrl</code>+<code>i</code></td>
</tr>
<tr>
<td>从电脑安装APK</td>
<td>拖放 APK 文件</td>
</tr>
<tr>
<td>推送文件到 <code>/sdcard/</code></td>
<td>拖放非 APK 文件</td>
</tr>
</tbody></table>
</div></div><a class="button-hover more" href="/bq/e331da33.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/a5683da5.html">windows包管理</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-06-03</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E5%B7%A5%E5%85%B7/%E5%8C%85%E7%AE%A1%E7%90%86/">包管理</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/scoop/">scoop</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Chocolatey/">Chocolatey</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Winget/">Winget</a></div></div><div class="post-content"><div class="main-content content"><h2 id="scoop"><a href="#scoop" class="headerlink" title="scoop"></a>scoop</h2><p>Scoop是一个 Win­dows 包管理工具，类似于 De­bian 的 <code>apt</code>、ma­cOS 的 <code>homebrew</code>。它由开源社区驱动，体验可能是是目前所有 Win­dows 包管理工具中最好的。对开发者来说，包管理器能非常方便的部署开发环境，比如 Python 、Node.js 。而对于像博主这样的普通的计算机使用者来说，可以方便的安装一些常用软件，尤其是开源软件，免去了手动去官网下载的繁琐步骤，而且后续对软件进行升级只需要输入一行命令，非常便捷。</p>
<p>官网:<a target="_blank" rel="noopener" href="https://scoop.sh/">https://scoop.sh/</a></p>
<p>参考:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lukesampson/scoop/wiki">https://github.com/lukesampson/scoop/wiki</a></p>
<p><a target="_blank" rel="noopener" href="https://sspai.com/post/52496">https://sspai.com/post/52496</a></p>
<p><a target="_blank" rel="noopener" href="https://chawyehsu.com/blog/talk-about-scoop-the-package-manager-for-windows-again">https://chawyehsu.com/blog/talk-about-scoop-the-package-manager-for-windows-again</a></p>
<h3 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Windows 7 SP1 + / Windows Server 2008+</span><br><span class="line">PowerShell 5(或更高版本，包括 PowerShell Core)和 .NET Framework 4.5（或更高版本）</span><br><span class="line">Windows 用户名为英文（Windows 用户环境变量中路径值不支持中文字符）</span><br><span class="line">正常、快速的访问 GitHub 并下载资源</span><br></pre></td></tr></table></figure>

<p>安装 Scoop 若Powershell或.NET Franmework版本过旧，更新后重启即可。若不清楚版本号，可<code>Win+R</code>运行powershell，输入以下命令获取版本号。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$PSVersionTable</span>.PSVersion.Major   <span class="comment">#查看Powershell版本</span></span><br><span class="line"><span class="variable">$PSVersionTable</span>.CLRVersion.Major  <span class="comment">#查看.NET Framework版本</span></span><br></pre></td></tr></table></figure>

<h3 id="安装scoop"><a href="#安装scoop" class="headerlink" title="安装scoop"></a>安装scoop</h3><p>Scoop 默认使用普通用户权限，其本体和安装的软件默认会放在 <code>%USERPROFILE%\scoop</code>(即 <code>C:\Users\用户名\scoop</code>)，使用管理员权限进行全局安装 (<code>-g</code>) 的软件在 <code>C:\ProgramData\scoop</code>。如果有自定安装路径的需求，那么要提前设置好环境变量，否则后续再改不是一件容易的事情。</p>
<ul>
<li>打开 PowerShell</li>
<li>设置用户安装路径</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">env:SCOOP=<span class="string">&#x27;D:\Scoop&#x27;</span></span></span><br><span class="line">[Environment]::SetEnvironmentVariable(&#x27;SCOOP&#x27;, $env:SCOOP, &#x27;User&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li>设置全局安装路径（需要管理员权限）</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">env:SCOOP_GLOBAL=<span class="string">&#x27;D:\Scoop_Global&#x27;</span></span></span><br><span class="line">[Environment]::SetEnvironmentVariable(&#x27;SCOOP_GLOBAL&#x27;, $env:SCOOP_GLOBAL, &#x27;Machine&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li>设置允许 PowerShell 执行本地脚本</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</span><br></pre></td></tr></table></figure>

<ul>
<li>没安装过 Git 则需要安装。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install git</span><br></pre></td></tr></table></figure>


<ul>
<li>安装 Scoop</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iwr -useb get.scoop.sh | iex</span><br></pre></td></tr></table></figure>

<p>如果下载scoop的过程中断，那么必须先删除<code>(C:\Users\&lt;user&gt;\scoop)</code>文件夹，再执行以上命令安装。<br>下载完成后，输入<code>scoop</code>出现如下帮助即安装成功。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Usage: scoop &lt;command&gt; [&lt;args&gt;]</span><br><span class="line"></span><br><span class="line">Some useful commands are:</span><br><span class="line"></span><br><span class="line">alias       Manage scoop aliases</span><br><span class="line">bucket      Manage Scoop buckets</span><br><span class="line">cache       Show or clear the download cache</span><br><span class="line">checkup     Check for potential problems</span><br><span class="line">cleanup     Cleanup apps by removing old versions</span><br><span class="line">config      Get or set configuration values</span><br><span class="line">create      Create a custom app manifest</span><br><span class="line">depends     List dependencies for an app</span><br><span class="line">export      Exports (an importable) list of installed apps</span><br><span class="line">help        Show help for a command</span><br><span class="line">hold        Hold an app to disable updates</span><br><span class="line">home        Opens the app homepage</span><br><span class="line">info        Display information about an app</span><br><span class="line">install     Install apps</span><br><span class="line">list        List installed apps</span><br><span class="line">prefix      Returns the path to the specified app</span><br><span class="line">reset       Reset an app to resolve conflicts</span><br><span class="line">search      Search available apps</span><br><span class="line">status      Show status and check for new app versions</span><br><span class="line">unhold      Unhold an app to enable updates</span><br><span class="line">uninstall   Uninstall an app</span><br><span class="line">update      Update apps, or Scoop itself</span><br><span class="line">virustotal  Look for app&#x27;s hash on virustotal.com</span><br><span class="line">which       Locate a shim/executable (similar to &#x27;which&#x27; on Linux)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Type &#x27;scoop help &lt;command&gt;&#x27; to get help for a specific command.</span><br></pre></td></tr></table></figure>

<h3 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h3><ul>
<li>命令列表</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scoop search &lt;app&gt; # 搜索软件</span><br><span class="line">scoop install &lt;app&gt; # 安装软件</span><br><span class="line">scoop info &lt;app&gt; # 查看软件详细信息</span><br><span class="line">scoop list # 查看已安装软件</span><br><span class="line">scoop uninstall &lt;app&gt; # 卸载软件，`-p`删除配置文件。</span><br><span class="line">scoop update # 更新 scoop 本体和软件列表</span><br><span class="line">scoop update &lt;app&gt; # 更新指定软件</span><br><span class="line">scoop update * # 更新所有已安装的软件</span><br><span class="line">scoop checkup # 检查 scoop 的问题并给出解决问题的建议</span><br><span class="line">scoop help # 查看命令列表</span><br><span class="line">scoop help &lt;command&gt; # 查看命令帮助说明</span><br></pre></td></tr></table></figure>

<h3 id="进阶使用"><a href="#进阶使用" class="headerlink" title="进阶使用"></a>进阶使用</h3><h4 id="添加-bucket"><a href="#添加-bucket" class="headerlink" title="添加 bucket"></a>添加 bucket</h4><p>所有的包管理器都会有相应的软件仓库 ，而 bucket 就是 Scoop 中的软件仓库。细心的你可能会发现 <code>scoop</code> 翻译为中文是 “舀”，而 <code>bucket</code> 是 “水桶”，所以安装软件可以理解为从水桶里舀水。</p>
<p>Scoop 默认软件仓库（main bucket）软件数量是有限的，但是可以进行额外的添加。通过 <code>scoop bucket known</code> 命令可以查看官方认可的 bucket：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> scoop bucket known</span></span><br><span class="line">main</span><br><span class="line">extras</span><br><span class="line">versions</span><br><span class="line">nightlies</span><br><span class="line">nirsoft</span><br><span class="line">php</span><br><span class="line">nerd-fonts</span><br><span class="line">nonportable</span><br><span class="line">java</span><br><span class="line">games</span><br><span class="line">jetbrains</span><br></pre></td></tr></table></figure>

<p>以上官方认可的 bucket 可以通过下面这个命令直接添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add &lt;bucketname&gt;</span><br></pre></td></tr></table></figure>

<p>extras涵盖了大部分因为种种原因不能被收录进主仓库的常用软件，这个是强推荐添加的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add extras</span><br></pre></td></tr></table></figure>

<p>比如写盘工具 Ru­fus 就在 <code>extras</code> 这个仓库中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install rufus</span><br></pre></td></tr></table></figure>

<p>nerd-fonts包含了美化终端时会用到的 Pow­er­line 字体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add nerd-fonts</span><br></pre></td></tr></table></figure>

<p>当添加 <code>nerd-fonts</code> 仓库后可以通过以下命令搜索到所有的字体：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop search &quot;-NF&quot;</span><br></pre></td></tr></table></figure>

<p>安装字体需要使用管理员权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scoop install FiraCode-NF</span><br></pre></td></tr></table></figure>

<h4 id="第三方-bucket"><a href="#第三方-bucket" class="headerlink" title="第三方 bucket"></a>第三方 bucket</h4><p>添加第三方 bucket</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add &lt;bucketname&gt; https:&#x2F;&#x2F;github.com&#x2F;xxx&#x2F;xxx</span><br></pre></td></tr></table></figure>

<p>从第三方 bucket 中安装软件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install &lt;bucketname&gt;&#x2F;&lt;app&gt;</span><br></pre></td></tr></table></figure>

<h4 id="清理安装包缓存"><a href="#清理安装包缓存" class="headerlink" title="清理安装包缓存"></a>清理安装包缓存</h4><p>Scoop 会保留下载的安装包，对于卸载后又想再安装的情况，不需要重复下载。但长期累积会占用大量的磁盘空间，如果用不到就成了垃圾。这时可以使用 <code>scoop cache</code> 命令来清理。</p>
<ul>
<li><code>scoop cache show</code> - 显示安装包缓存</li>
<li><code>scoop cache rm &lt;app&gt;</code> - 删除指定应用的安装包缓存</li>
<li><code>scoop cache rm *</code> - 删除所有的安装包缓存</li>
</ul>
<p>如果你不希望安装和更新软件时保留安装包缓存，可以加上 <code>-k</code> 或 <code>--no-cache</code> 选项来禁用缓存：</p>
<ul>
<li><code>scoop install -k &lt;app&gt;</code></li>
<li><code>scoop update -k *</code></li>
</ul>
<h4 id="删除旧版本软件"><a href="#删除旧版本软件" class="headerlink" title="删除旧版本软件"></a>删除旧版本软件</h4><p>当软件被更新后 Scoop 还会保留软件的旧版本，更新软件后可以通过 <code>scoop cleanup</code> 命令进行删除。</p>
<ul>
<li><code>scoop cleanup &lt;app&gt;</code> - 删除指定软件的旧版本</li>
<li><code>scoop cleanup *</code> - 删除所有软件的旧版本</li>
</ul>
<p>与安装软件一样，删除旧版本软件的同时也可以清理安装包缓存，同样是加上 <code>-k</code> 选项。</p>
<ul>
<li><code>scoop cleanup -k &lt;app&gt;</code> - 删除指定软件的旧版本并清除安装包缓存</li>
<li><code>scoop cleanup -k *</code> - 删除所有软件的旧版本并清除安装包缓存</li>
</ul>
<h4 id="全局安装"><a href="#全局安装" class="headerlink" title="全局安装"></a>全局安装</h4><p>全局安装就是给系统中的所有用户都安装，且环境变量是系统变量，对于需要设置系统变量的一些软件就需要全局安装，比如 Node.js、Python ，否则某些情况会出现无法找到命令的问题。</p>
<p>使用 <code>scoop install &lt;app&gt;</code> 命令加上 <code>-g</code> 或 <code>--global</code> 选项可对软件进行全局安装，全局安装需要管理员权限，所以需要提前以管理员权限运行的 Pow­er­Shell 。更简单的方式是先安装 <code>sudo</code>，然后用 <code>sudo</code> 命令来提权执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scoop install sudo</span><br><span class="line">sudo scoop install -g &lt;app&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>达成在 Win­dows 上使用<code>sudo</code>的成就</p>
</blockquote>
<p>使用 <code>scoop list</code> 命令查看已装软件时，全局安装的软件末尾会有 <code>*global*</code> 标志。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> scoop list</span></span><br><span class="line">Installed apps:</span><br><span class="line"></span><br><span class="line">  7zip 19.00</span><br><span class="line">  ffmpeg 4.2.3</span><br><span class="line">  git 2.26.2.windows.1 *global*</span><br><span class="line">  nodejs-lts 12.17.0 *global*</span><br><span class="line">  python 3.8.3 *global*</span><br><span class="line">  screentogif 2.24.2 [extras]</span><br><span class="line">  sudo 0.2020.01.26</span><br></pre></td></tr></table></figure>

<p>此外对于全局软件的更新和卸载等其它操作，都需要加上 <code>-g</code> 选项：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo scoop update -g * # 更新所有软件（且包含全局软件）</span><br><span class="line">sudo scoop uninstall -g &lt;app&gt; # 卸载全局软件</span><br><span class="line">sudo scoop uninstall -gp &lt;app&gt; # 卸载全局软件（并删除配置文件）</span><br><span class="line">sudo scoop cleanup -g * # 删除所有全局软件的旧版本</span><br><span class="line">sudo scoop cleanup -gk * # 删除所有全局软件的旧版本（并清除安装包包缓存）</span><br></pre></td></tr></table></figure>

<h4 id="代理设置"><a href="#代理设置" class="headerlink" title="代理设置"></a>代理设置</h4><p>Scoop 默认使用的是系统代理，如果你想手动指定代理，可以输入下面的命令。需要注意的是只支持 http 协议。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop config proxy localhost:1080</span><br></pre></td></tr></table></figure>

<blockquote>
<p>设置完可以通过<code>scoop config proxy</code>查看。</p>
</blockquote>
<p>如果你想取消代理，那么输入下面的命令，这将会恢复使用系统代理。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop config rm proxy</span><br></pre></td></tr></table></figure>

<h4 id="开启多线程下载"><a href="#开启多线程下载" class="headerlink" title="开启多线程下载"></a>开启多线程下载</h4><p>使用 Scoop 安装 Aria2 后，Scoop 会自动调用 Aria2 进行多线程加速下载。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install aria2</span><br></pre></td></tr></table></figure>

<p>使用 <code>scoop config</code> 命令可以对 Aria2 进行设置，比如 <code>scoop config aria2-enabled false</code> 可以禁止调用 Aria2 下载。以下是与 Aria2 有关的设置选项：</p>
<ul>
<li><code>aria2-enabled</code>: 开启 Aria2 下载，默认<code>true</code></li>
<li><code>aria2-retry-wait</code>: 重试等待秒数，默认<code>2</code></li>
<li><code>aria2-split</code>: 单任务最大连接数，默认<code>5</code></li>
<li><code>aria2-max-connection-per-server</code>: 单服务器最大连接数，默认<code>5</code> ，最大<code>16</code></li>
<li><code>aria2-min-split-size</code>: 最小文件分片大小，默认<code>5M</code></li>
</ul>
<p>这里推荐以下优化设置，单任务最大连接数设置为 <code>32</code>，单服务器最大连接数设置为 <code>16</code>，最小文件分片大小设置为 <code>1M</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scoop config aria2-split 32</span><br><span class="line">scoop config aria2-max-connection-per-server 16</span><br><span class="line">scoop config aria2-min-split-size 1M</span><br></pre></td></tr></table></figure>

<h3 id="常用命令总结"><a href="#常用命令总结" class="headerlink" title="常用命令总结"></a>常用命令总结</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 更新 scoop 及软件包列表</span></span><br><span class="line">scoop update</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 安装软件 ##</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 非全局安装（并禁止安装包缓存）</span></span><br><span class="line">scoop install -k &lt;app&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 全局安装（并禁止安装包缓存）</span></span><br><span class="line">sudo scoop install -gk &lt;app&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 卸载软件 ##</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 卸载非全局软件（并删除配置文件）</span></span><br><span class="line">scoop uninstall -p &lt;app&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 卸载全局软件（并删除配置文件）</span></span><br><span class="line">sudo scoop uninstall -gp &lt;app&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 更新软件 ##</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新所有非全局软件（并禁止安装包缓存）</span></span><br><span class="line">scoop update -k *</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新所有软件（并禁止安装包缓存）</span></span><br><span class="line">sudo scoop update -gk *</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 垃圾清理 ##</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除所有旧版本非全局软件（并删除软件包缓存）</span></span><br><span class="line">scoop cleanup -k *</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除所有旧版本软件（并删除软件包缓存）</span></span><br><span class="line">sudo scoop cleanup -gk *</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清除软件包缓存</span></span><br><span class="line">scoop cache rm *</span><br></pre></td></tr></table></figure>

<h2 id="Chocolatey"><a href="#Chocolatey" class="headerlink" title="Chocolatey"></a>Chocolatey</h2><p>Chocolatey是一款专为Windows系统开发的、基于NuGet的包管理器工具，类似于Node.js的npm，MacOS的 brew，Ubuntu的 apt-get，简称为 choco。<br>Chocolatey的设计目标是成为一个去中心化的框架，便于开发者按需快速安装应用程序和工具。</p>
<p>Chocolatey 官网： <a target="_blank" rel="noopener" href="https://chocolatey.org/">https://chocolatey.org/</a></p>
<p>软件源:<a target="_blank" rel="noopener" href="https://community.chocolatey.org/packages">https://community.chocolatey.org/packages</a></p>
<p>github:<a target="_blank" rel="noopener" href="https://github.com/chocolatey/choco">https://github.com/chocolatey/choco</a></p>
<p>参考:</p>
<p><a target="_blank" rel="noopener" href="https://guangchuangyu.github.io/cn/2018/06/chocolatey/">https://guangchuangyu.github.io/cn/2018/06/chocolatey/</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>使用以管理员权限打开PowerShell</p>
<p>运行 <code>Get-ExecutionPolicy</code>，如果结果是 <code>Restricted</code>，则运行 <code>Set-ExecutionPolicy AllSigned</code> 或者 <code>Set-ExecutionPolicy Bypass -Scope Process</code></p>
<p>输入并执行如下命令：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Bypass <span class="literal">-Scope</span> <span class="keyword">Process</span> <span class="literal">-Force</span>; <span class="built_in">iex</span> ((<span class="built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="string">&#x27;https://chocolatey.org/install.ps1&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">iex</span> ((<span class="built_in">new-object</span> net.webclient).DownloadString(<span class="string">&#x27;https://chocolatey.org/install.ps1&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>Chocolatey的作者创建了一个短网址，包含了Chocolatey的安装脚本。嫌上面的太长的话，可以用这个：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">iwr</span> https://cin.st | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure>

<h4 id="自定义安装位置"><a href="#自定义安装位置" class="headerlink" title="自定义安装位置"></a>自定义安装位置</h4><p>以上都是安装到了默认位置<code>C:\ProgramData\Chocolatey</code>，如果现在其他地方安装Chocolatey的话，需要新建一个环境变量<code>ChocolateyInstall</code>，值是你希望安装到的文件夹。然后手动创建这个文件夹。然后再运行上面的命令。如果已经安装了，可以再次运行安装命令，这样可以重新安装到你指定的位置。</p>
<h3 id="包列表"><a href="#包列表" class="headerlink" title="包列表"></a>包列表</h3><p>通过官网 <a target="_blank" rel="noopener" href="https://chocolatey.org/packages">https://chocolatey.org/packages</a> 可以图形界面浏览各软件包，以及安装命令</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ul>
<li>search - 搜索包 <code>choco search something</code></li>
<li>list - 列出包 <code>choco list -lo</code></li>
<li>install - 安装 <code>choco install baretail</code></li>
<li>pin - 固定包的版本，防止包被升级 <code>choco pin windirstat</code></li>
<li>upgrade - 安装包的升级 <code>choco upgrade baretail</code></li>
<li>uninstall - 安装包的卸载 <code>choco uninstall baretail</code></li>
</ul>
<p>更多命令可以通过 <code>choco -help</code> 查看</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">choco install autohotkey.portable    <span class="comment">#安装 AutoHotkey (Portable)</span></span><br><span class="line">choco install nodejs.install  <span class="comment">#安装 node</span></span><br><span class="line">choco install git.install     <span class="comment">#安装 git</span></span><br><span class="line">choco install python          <span class="comment">#安装 python</span></span><br><span class="line">choco install ruby            <span class="comment">#安装 ruby</span></span><br><span class="line">choco install jdk8            <span class="comment">#安装 JDK8</span></span><br><span class="line">choco install googlechrome    <span class="comment">#安装 Chrome</span></span><br><span class="line">choco install google<span class="literal">-chrome</span><span class="literal">-x64</span> <span class="comment">#Google Chrome (64-bit only)</span></span><br><span class="line">choco install firefox         <span class="comment">#安装 firefox</span></span><br><span class="line">choco install notepadplusplus.install <span class="comment">#安装 notepad++</span></span><br><span class="line">choco install Atom                    <span class="comment">#安装 Atom</span></span><br><span class="line">choco install SublimeText3            <span class="comment">#安装 SublimeText3</span></span><br></pre></td></tr></table></figure>

<h2 id="Winget"><a href="#Winget" class="headerlink" title="Winget"></a>Winget</h2><p>官方文档:<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/">https://docs.microsoft.com/zh-cn/windows/package-manager/winget/</a></p>
<p>github:<a target="_blank" rel="noopener" href="https://github.com/microsoft/winget-cli">https://github.com/microsoft/winget-cli</a></p>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><ul>
<li><p>法1：提交 WinGet 的预览体验申请，Win10 商店下载</p>
</li>
<li><p>法2：申请加入 Windows Insider，Win10 商店下载</p>
</li>
<li><p>法3：GitHub下载安装包直接安装</p>
</li>
</ul>
<p>推荐法3，简单直接， 在 GitHub 搜索 WinGet，microsoft/winget-cli 就是该项目。在 releases 页面下载名为 Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.appxbundle 的软件安装包。</p>
<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><p>安装 应用安装程序 后，可以通过在命令提示符下键入 “winget” 来运行 WinGet 。最常见的使用场景之一是搜索并安装你最喜欢的工具。若要搜索某个工具，请键入 <code>winget search \&lt;appname&gt;</code></p>
<p>确认你需要的工具可用后，可以通过键入 <code>winget install \&lt;appname&gt;</code> 来安装该工具。 WinGet 工具会启动安装程序，将应用程序安装在你的电脑上。</p>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/hash">hash</a></td>
<td align="left">为安装程序生成 SHA256 哈希。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/help">help</a></td>
<td align="left">显示 <strong>winget</strong> 工具命令的帮助信息。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/install">install</a></td>
<td align="left">安装指定的应用程序。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/search">search</a></td>
<td align="left">搜索某个应用程序。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/show">show</a></td>
<td align="left">显示指定应用程序的详细信息。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/source">source</a></td>
<td align="left">添加、删除和更新 <strong>winget</strong> 工具访问的 Windows 程序包管理器存储库。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/package-manager/winget/validate">validate</a></td>
<td align="left">验证要提交到 Windows 程序包管理器存储库的清单文件。</td>
</tr>
</tbody></table>
</div></div><a class="button-hover more" href="/bq/a5683da5.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/cde9291a.html">自动化测试相关工具简介</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-04-11</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/tool/">tool</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/automation/">automation</a></div></div><div class="post-content"><div class="main-content content"><h4 id="Framework-and-tools"><a href="#Framework-and-tools" class="headerlink" title="Framework and tools"></a>Framework and tools</h4><p>测试框架：Unittest/Pytest/nose、Allure；<br>接口⾃动化测试：Requests/HttpRunner<br>app/web⾃动化测试：Appium，Selenium<br>性能测试：locust<br>设计模式：PageObject(POM)<br>测试开发：Django，Flask<br>代码管理 Git<br>代码分析 FindBugs Sonar<br>单元测试 JUnit<br>持续集成管理 Jenkins<br>⾃动化环境构建：Docker<br>⾃动化测试、研发、预发布环境管理：Chef、Puppet、Docker</p>
<h3 id="service"><a href="#service" class="headerlink" title="service"></a>service</h3><h4 id="python-cgi"><a href="#python-cgi" class="headerlink" title="python cgi"></a>python cgi</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 需要创建cgi-bin目录</span></span><br><span class="line">python2 -m CGIHTTPServer 8080</span><br><span class="line">python3 -m http.server --cgi 8000</span><br></pre></td></tr></table></figure>

<h4 id="模拟服务"><a href="#模拟服务" class="headerlink" title="模拟服务"></a>模拟服务</h4><p>moco:<a target="_blank" rel="noopener" href="https://github.com/dreamhead/moco">https://github.com/dreamhead/moco</a></p>
<h3 id="Third-party-library"><a href="#Third-party-library" class="headerlink" title="Third party library"></a>Third party library</h3><h4 id="断言库"><a href="#断言库" class="headerlink" title="断言库"></a>断言库</h4><p>jsonpath<br>hamcrest<br>jsonschema</p>
<p>http断言：BeautifulSoup  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install bs4</span><br><span class="line">pip install lxml</span><br></pre></td></tr></table></figure>

<h4 id="通用参数化"><a href="#通用参数化" class="headerlink" title="通用参数化"></a>通用参数化</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install parameterized</span><br></pre></td></tr></table></figure>

<h3 id="模板技术"><a href="#模板技术" class="headerlink" title="模板技术"></a>模板技术</h3><p>template<br>nustache<br>jinja2</p>
<h3 id="测开工具"><a href="#测开工具" class="headerlink" title="测开工具"></a>测开工具</h3><h4 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h4><p>poetry</p>
<h4 id="CI"><a href="#CI" class="headerlink" title="CI"></a>CI</h4><p>travisCI</p>
<h4 id="python代码覆盖coveralls报告"><a href="#python代码覆盖coveralls报告" class="headerlink" title="python代码覆盖coveralls报告"></a>python代码覆盖coveralls报告</h4><p>coverage </p>
<h4 id="命令行支持"><a href="#命令行支持" class="headerlink" title="命令行支持"></a>命令行支持</h4><p>argparse包 </p>
</div></div><a class="button-hover more" href="/bq/cde9291a.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/dccd834b.html">元素定位</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-04-11</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/automation/">automation</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/xpath/">xpath</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/CSS-Path/">CSS Path</a></div></div><div class="post-content"><div class="main-content content"><table>
<thead>
<tr>
<th>描述</th>
<th>Xpath</th>
<th>CSS Path</th>
</tr>
</thead>
<tbody><tr>
<td>直接子元素</td>
<td>//div/a</td>
<td>div &gt; a</td>
</tr>
<tr>
<td>子元素或后代元素</td>
<td>//div//a</td>
<td>div a</td>
</tr>
<tr>
<td>以id定位</td>
<td>//div[@id=’idValue’]//a</td>
<td>div#idValue a</td>
</tr>
<tr>
<td>以class定位</td>
<td>//div[@class=’classValue’]//a</td>
<td>div.classValue a</td>
</tr>
<tr>
<td>同级弟弟元素</td>
<td>//ul/li[@class=’first’]/following-sibling::li</td>
<td>ul&gt;li.first + li</td>
</tr>
<tr>
<td>属性</td>
<td>//form/input[@name=’username’]</td>
<td>form input[name=’username’]</td>
</tr>
<tr>
<td>多个属性</td>
<td>//input[@name=’continue’ and @type=‘button’]</td>
<td>input[name=’continue’][type=’button’]</td>
</tr>
<tr>
<td>第4个子元素</td>
<td>//ul[@id=’list’]/li[4]</td>
<td>ul#list li:nth-child(4)</td>
</tr>
<tr>
<td>第1个子元素</td>
<td>//ul[@id=’list’]/li[1]</td>
<td>ul#list li:first-child</td>
</tr>
<tr>
<td>最后1个子元素</td>
<td>//ul[@id=’list’]/li[last()]</td>
<td>ul#list li:last-child</td>
</tr>
<tr>
<td>属性包含某字段</td>
<td>//div[contains(@title,’Title’)]</td>
<td>div[title*=”Title”]</td>
</tr>
<tr>
<td>属性以某字段开头</td>
<td>//input[starts-with(@name,’user’)]</td>
<td>input[name^=”user”]</td>
</tr>
<tr>
<td>属性以某字段结尾</td>
<td>//input[ends-with(@name,’name’)]</td>
<td>input[name$=”name”]</td>
</tr>
<tr>
<td>text中包含某字段</td>
<td>//div[contains(text(), ‘text’)]</td>
<td>无法定位</td>
</tr>
<tr>
<td>元素有某属性</td>
<td>//div[@title]</td>
<td>div[title]</td>
</tr>
<tr>
<td>父节点</td>
<td>//div/..</td>
<td>无法定位</td>
</tr>
<tr>
<td>同级哥哥节点</td>
<td>//li/preceding-sibling::div[1]</td>
<td>无法定位</td>
</tr>
</tbody></table>
<h3 id="xpath"><a href="#xpath" class="headerlink" title="xpath"></a>xpath</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 绝对定位 </span></span><br><span class="line">/xxx/ddd/dddd</span><br><span class="line"><span class="meta">#</span><span class="bash">相对定位 </span></span><br><span class="line">//android.widget.Button</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找所有元素：</span></span><br><span class="line">//*</span><br><span class="line"><span class="meta">#</span><span class="bash"> 包含条件：</span></span><br><span class="line">//*[contains(@resource-id, ‘login’)]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 满⾜属性值</span></span><br><span class="line">//*[@text=‘登录’]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 多条件联合</span></span><br><span class="line">//*[contains(@resource-id, ‘login’) and contains(@text, ‘登录’)]]</span><br><span class="line">//*[contains(@text, ‘登录’) or contains(@label, ‘登录’)]]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 当多控件同时出现</span></span><br><span class="line">//*[contains(@text, &#x27;看点&#x27;)]/ancestor::*//*[contains(name(), ‘EditText’)]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 根据可点击属性和⽂本内容长度筛选</span></span><br><span class="line">//*[@clickable=&quot;true&quot;]//android.widget.TextView[stringlength(@</span><br><span class="line"><span class="meta">text)&gt;</span><span class="bash">0 and string-length(@text)&lt;20]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//*[@id=&quot;select_baseUrl&quot;]/option</span><br><span class="line"><span class="meta">$</span><span class="bash">x(<span class="string">&#x27;//*[@id=&quot;select_baseUrl&quot;]//option[@value]&#x27;</span>)[0].value</span></span><br><span class="line"></span><br><span class="line">//*[android.widget.EditText]</span><br><span class="line">//*[@class=&#x27;android.widget.EditText&#x27; and contains(@content-desc, &#x27;&#x27;)]</span><br><span class="line"><span class="meta">#</span><span class="bash"> toast识别条件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> automationName：uiautomator2</span></span><br><span class="line">getPageSource是⽆法找到的,必须使⽤xpath查找</span><br><span class="line">//*[@class=&#x27;android.widget.Toast&#x27;]</span><br><span class="line">//*[contains(@text, &quot;xxxxx&quot;)]</span><br><span class="line"><span class="meta">$</span><span class="bash">x(<span class="string">&#x27;//*[contains(text(),&quot;B10资源参数&quot;)]&#x27;</span>)</span></span><br><span class="line"><span class="meta">$</span><span class="bash">x(<span class="string">&#x27;//div[contains(text(),&quot;B10资源参数&quot;)]&#x27;</span>)</span></span><br></pre></td></tr></table></figure>

<h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(<span class="string">&#x27;span[class=&quot;e_ico-add&quot;]&#x27;</span>)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



</div></div><a class="button-hover more" href="/bq/dccd834b.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/bfa86649.html">Linux三剑客</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-02-04</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Linux/">Linux</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Linux/Shell/">Shell</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/grep/">grep</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/sed/">sed</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/awk/">awk</a></div></div><div class="post-content"><div class="main-content content"><h3 id="example"><a href="#example" class="headerlink" title="example"></a>example</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">点赞人数统计</span></span><br><span class="line">a=$(curl -s https://testerhome.com/topics|grep -o &#x27;href=&quot;/topics/[0-9]*&quot;&#x27;|awk -F &#x27;/|&quot;&#x27; &#x27;&#123;print $4&#125;&#x27;);for id in $a;do url=&#x27;https://testerhome.com/topics/&#x27;$id;zan=$(curl -s $url|grep -o -m1 &#x27;&lt;span&gt;[0-9]*&#x27;|awk -F &#x27;&gt;&#x27; &#x27;&#123;print $2&#125;&#x27;);if [ -n &quot;$zan&quot; ];then echo $url &#x27;点赞人数&#x27; $zan;else echo $url &#x27;点赞人数&#x27; 0;fi;done|awk -F &#x27;/&#x27; &#x27;&#123;print $NF&#125;&#x27;</span><br><span class="line"></span><br><span class="line">echo -e &quot;1|2|3\n4|5|6\n7|8|9&quot;|awk -F &#x27;|&#x27; &#x27;BEGIN&#123;a=0&#125;&#123;a=a+$2&#125;END&#123;print a&#125;&#x27;</span><br><span class="line"></span><br><span class="line">curl -s https://www.baidu.com/ |grep href |grep -o &quot;http[^&gt;]*&quot; | while read line;do curl -s -I $line | grep 200 &amp;&gt;/dev/null &amp;&amp; echo 200 $line || echo ERR $line;done</span><br><span class="line"></span><br><span class="line">curl https://testerhome.com/api/v3/topics.json 2&gt;/dev/null | sed &#x27;s/&quot;title&quot;:&quot;[^&quot;]*/title&quot;:&quot;xxxxxx&quot;/g&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">统计nginx日志访问量最高</span></span><br><span class="line">awk &#123;&#x27;print $7&#x27;&#125; nginx.log |awk -F &#x27;?&#x27; &#x27;&#123;print $1&#125;&#x27; |sort |uniq -c |sort -n |tail -1 |awk &#x27;&#123;print $2&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">平均耗时</span></span><br><span class="line">awk &#123;&#x27;print $7,$(NF-1)&#x27;&#125; nginx.log | grep &#x27;^/api/[a-z0-9_]*&#x27; |awk &#x27;&#123;s+=$2&#125; END&#123;print s/NR&#125;&#x27;</span><br><span class="line"></span><br><span class="line">awk &#x27;$7~/api\/[a-z]+$/&#123;sum+=$(NF-1)&#125;END&#123;print sum/NR&#125;&#x27; nginx.log</span><br><span class="line"></span><br><span class="line">seq 10|awk &#x27;/[5-9]/&#x27;</span><br><span class="line">seq 10|awk &#x27;/5/,/9/&#x27;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">分割</span></span><br><span class="line">echo &#x27;1|2#3_4&#x27; | awk -F &#x27;#_|_|\\|&#x27; &#x27;&#123;print $1&#125;&#x27; </span><br><span class="line">echo &#x27;1|2#3_4&#x27; | awk &#x27;BEGIN&#123;FS=&quot;#|_|\\|&quot;&#125;&#123;print $1&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">分割加分割符</span></span><br><span class="line">echo &#x27;1|2#3_4&#x27; | awk &#x27;BEGIN&#123;FS=&quot;#|_|\\|&quot;;OFS=&quot;_&quot;&#125;&#123;print $1,$2,$3,$4&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">分成多行</span></span><br><span class="line">echo &#x27;1|2#3_4&#x27; | awk &#x27;BEGIN&#123;RS=&quot;#|_|\\|&quot;&#125;&#123;print $1&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">分成多行拼成一行</span></span><br><span class="line">echo &#x27;1|2#3_4&#x27; | awk &#x27;BEGIN&#123;RS=&quot;#|_|\\|&quot;;ORS=&quot;_&quot;&#125;&#123;print $1&#125;&#x27;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">awk格式化输出</span></span><br><span class="line">awk &#x27;BEGIN&#123;printf &quot;%.1f\n&quot;,1/3&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">求和</span></span><br><span class="line">seq 10 2 20| awk &#x27;&#123;sum+=$1&#125;&#123;print sum&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">求平均</span></span><br><span class="line">seq 10 2 20| awk &#x27;&#123;sum+=$1&#125;&#123;print sum/NR&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">输出大于14的</span></span><br><span class="line">seq 10 2 20| awk &#x27;$1&gt;14&#123;data[NR]=$1&#125;END&#123;for(k in data)print data[k]&#125;&#x27;</span><br><span class="line"><span class="meta">#</span><span class="bash">多点编辑(取出后两位)</span></span><br><span class="line">seq 125 137|sed -E &#x27;s#.(.)(.)#\1+\2#g&#x27;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">根据pid查看20秒内程序cpu，mem使用信息</span></span><br><span class="line">for i in $(seq 1 20);do time=$(date +%H:%M:%S);cpu=$(ps -o %cpu -o %mem pid| tail -1);echo $time $cpu;sleep 1;done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">并发</span></span><br><span class="line">while true; do count=$(jobs -l |grep Running | wc -l);[ $count -le 2 ] &amp;&amp; &#123; time curl https://www.baidu.com &amp;&gt;/dev/null &amp; &#125; || echo $count waiting;done   </span><br><span class="line"></span><br><span class="line">ps -o uname,pid,ppid,thcount,ni,pri,psr,pcpu,pmem,rss,vsz,sz,start_time,time,comm,command -e </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">20秒内存平均</span></span><br><span class="line">timeall=0; for i in $(seq 1 20);do time=$(date +%H:%M:%S);MEM=$(ps -o uname,pid,ppid,thcount,ni,pri,psr,pcpu,pmem,rss,vsz,sz,start_time,time,comm,command -p 9446 | awk -F &#x27; *&#x27; &#x27;&#123;print $9&#125;&#x27; | tail -1);echo $time %MEM=$MEM ;timeall=$(awk &#x27;BEGIN&#123;print &#x27;$timeall&#x27;+&#x27;$MEM&#x27;&#125;&#x27;); awk &#x27;BEGIN&#123;print &#x27;$timeall&#x27;/&#x27;$i&#x27;&#125;&#x27; ;sleep 1;done</span><br><span class="line"></span><br><span class="line">for i in $(seq 1 20);do time=$(date +%H:%M:%S);MEM=$(ps -o uname,pid,ppid,thcount,ni,pri,psr,pcpu,pmem,rss,vsz,sz,start_time,time,comm,command -p 9446 | awk -F &#x27; *&#x27; &#x27;&#123;print $9&#125;&#x27; | tail -1);echo $time %MEM= $MEM ;sleep 1;done | awk &#x27;&#123;print $0,t+=$3;print t/NR&#125;&#x27;</span><br><span class="line"></span><br><span class="line">for i in $(seq 1 20);do time=$(date +%H:%M:%S);MEM=$(ps -o uname,pid,ppid,thcount,ni,pri,psr,pcpu,pmem,rss,vsz,sz,start_time,time,comm,command -p 9446 | awk -F &#x27; *&#x27; &#x27;&#123;print $9&#125;&#x27; | tail -1);echo $time %MEM= $MEM ;sleep 1;done | awk &#x27;&#123;print $0;print (t+=$3)/NR&#125;&#x27; </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">打印cpu 内存</span></span><br><span class="line">top -b -d 1 -n 20 -p 9446|grep --line-buffered 9446 | awk &#x27;&#123;cpu+=$9;mem+=$10&#125;&#123;print $9,$10,cpu/NR,mem/NR&#125;&#x27;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">图形化cpu mem</span></span><br><span class="line">top -b -d 1 -n 20 -p 9446|grep --line-buffered 9446 | awk &#x27;&#123;cpu+=$9;mem+=$10&#125;&#123;print $9,$10,cpu/NR,mem/NR&#125;&#x27;|gnuplot -e &quot;set terminal dumb;plot &#x27;&lt;cat&#x27; using 1 with line&quot;</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/bq/bfa86649.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/ae82201a.html">pytest使用及相关插件</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-04-25</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/automation/">automation</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/python/">python</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/pytest/">pytest</a></div></div><div class="post-content"><div class="main-content content"><h3 id="编写规范："><a href="#编写规范：" class="headerlink" title="编写规范："></a>编写规范：</h3><p>• 测试⽂件以 test_ 开头（以 <em>test 结尾也可以）<br>• 测试类以 Test 开头，并且不能带有 <strong>init</strong> 方法!<br>• 测试函数以 test</em> 开</p>
<p>模块级（setup_module/teardown_module）模块始末，全局的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">开始于模块始末，全局的</span></span><br><span class="line"><span class="string">setup_module</span></span><br><span class="line"><span class="string">teardown_module</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup_module</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;setup_module():在模块最之前执行\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">teardown_module</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;teardown_module：在模块之后执行&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup_function</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;setup_function():每个方法之前执行&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">teardown_function</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;teardown_function():每个方法之后执行\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_01</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;正在执行test1&quot;</span></span><br><span class="line">    x = <span class="string">&quot;this&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="string">&#x27;h&#x27;</span> <span class="keyword">in</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_add</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;正在执行test_add()&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> add(<span class="number">3</span>,<span class="number">4</span>) == <span class="number">7</span></span><br><span class="line"><span class="comment">#运行结果：setup_module --&gt; setup_function --&gt; test_01--&gt; teardown_function --&gt; setup_function --&gt; test_add()--&gt; teardown_function --&gt; teardown_module</span></span><br></pre></td></tr></table></figure>

<p>函数级（setup_function/teardown_function）只对函数用例生效，而且不在类中使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup_function</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;setup_function():每个方法之前执行&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">teardown_function</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;teardown_function():每个方法之后执行&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_01</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;正在执行test1&quot;</span></span><br><span class="line">    x = <span class="string">&quot;this&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="string">&#x27;h&#x27;</span> <span class="keyword">in</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_02</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;正在执行test2&quot;</span></span><br><span class="line">    x = <span class="string">&quot;hello&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> hasattr(x,<span class="string">&quot;hello&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_add</span>():</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;正在执行test_add()&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> add(<span class="number">3</span>,<span class="number">4</span>) == <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pytest.main([<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;test_function.py&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#运行结果为：（-s为了显示用例的打印信息   -q只显示结果不显示过程）</span></span><br><span class="line"><span class="comment">#可以看出执行的结果是：</span></span><br><span class="line"><span class="comment">#setup_function--》 test_01 --》teardown_function</span></span><br><span class="line"><span class="comment">#setup_function--》 test_02 --》teardown_function</span></span><br><span class="line"><span class="comment">#setup_function--》 test_add  --》teardown_function</span></span><br></pre></td></tr></table></figure>

<p>类级（setup_class/teardown_class）在类中使用，类执行之前运行一次，类执行之后运行一次</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span>(<span class="params">object</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup_class</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;setup_class(self)：每个类之前执行一次&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown_class</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;teardown_class(self)：每个类之后执行一次&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">self,a,b</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;这是加法运算&quot;</span></span><br><span class="line">        <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_01</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;正在执行test1&quot;</span></span><br><span class="line">        x = <span class="string">&quot;this&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="string">&#x27;h&#x27;</span> <span class="keyword">in</span> x</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_add</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;正在执行test_add()&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> self.add(<span class="number">3</span>, <span class="number">4</span>) == <span class="number">7</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#执行顺序    setup_class --》 test1 --》test_add（）--》teardown_class</span></span><br></pre></td></tr></table></figure>

<p>⽅法级（setup_method/teardown_methond）运⾏在类中⽅法始末</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestMethod</span>(<span class="params">object</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup_class</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;setup_class(self)：每个类之前执行一次\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown_class</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;teardown_class(self)：每个类之后执行一次&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;setup_method(self):在每个方法之前执行&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">teardown_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;teardown_method(self):在每个方法之后执行\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">self,a,b</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;这是加法运算&quot;</span></span><br><span class="line">        <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_01</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;正在执行test1&quot;</span></span><br><span class="line">        x = <span class="string">&quot;this&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="string">&#x27;h&#x27;</span> <span class="keyword">in</span> x</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_add</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;正在执行test_add()&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> self.add(<span class="number">3</span>, <span class="number">4</span>) == <span class="number">7</span></span><br><span class="line"><span class="comment">#执行结果： setup_class --》 setup_method --&gt;test1 --&gt;teardown_method --》setup_method --&gt; test_add（）--》teardown_method --&gt; teardown_class</span></span><br></pre></td></tr></table></figure>



<h3 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h3><p>pytest/py.test（终端，命令⾏，pycharm都⾏，可配置pycharm使⽤pytest⽅式执⾏）<br>pytest –v (最⾼级别信息—verbose)<br>pytest -v -s ⽂件名 （s是带控制台输出结果，也是输出详细)<br>pytest将在当前⽬录及其⼦⽬录中运⾏test _ * .py或* <em>test.py形式的所有⽂件。</em><br>以test_开头的函数，以Test开头的类，以test_开头的⽅法。所有包package都要有<strong>init</strong>.py⽂件。<br>Pytest可以执⾏unittest框架写的⽤例和⽅法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行一个module</span></span><br><span class="line">pytest -v src/testcases/api/test_autouse.py</span><br><span class="line"><span class="comment"># 执⾏⼀个类，一个方法</span></span><br><span class="line">pytest -v src/testcases/api/test_autouse.py::TestSample</span><br><span class="line">pytest -v src/testcases/api/</span><br><span class="line">test_autouse.py::TestSample::test_answer</span><br><span class="line"><span class="comment"># 执⾏⼀个目录或者package</span></span><br><span class="line">pytest -v src/testcases/api!</span><br><span class="line"><span class="comment"># 通过标签来运行测试用例</span></span><br><span class="line">pytest -m P0 src/testcases/api/</span><br><span class="line"><span class="comment"># 通过pytest.main来执行，所有的参数和pytest命令行方式一样</span></span><br><span class="line">pytest.main([<span class="string">&#x27;-v&#x27;</span>, <span class="string">&#x27;--instafail&#x27;</span>, <span class="string">&#x27;testcases/api/test_example.py&#x27;</span>, <span class="string">&#x27;-m=P2&#x27;</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> pytest执⾏⽤例出错时停⽌</span></span><br><span class="line">pytest -x -v -s test.py --maxfail=2</span><br><span class="line"><span class="meta">#</span><span class="bash"> pytest通过⽂件名类名⽅法及组合调⽤部分⽤例执</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接输⼊⽂件名，类名</span></span><br><span class="line">pytest test_class_01.py</span><br><span class="line">pytest -v -s test_class_01.py</span><br><span class="line">pytest -v test_class_01.py::TestClass</span><br><span class="line">pytest -v test_class_01.py::TestClass::test_one</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使⽤-k TestClass是类名，and是运算符,还可以是and not…,test_one是⽅法名中含有的信息</span></span><br><span class="line">pytest -k &quot;TestClass and test_one&quot;</span><br><span class="line">pytest -k &quot;TestClass or test_one&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> mark标记执⾏</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在测试⽤例⽅法上加@pytest.mark.webtest，-s参数： 输出所有测试⽤的<span class="built_in">print</span>信息 -m：执⾏⾃定义标记的相关⽤例</span></span><br><span class="line">pytest -s test.py -m=webtest</span><br></pre></td></tr></table></figure>

<h3 id="log"><a href="#log" class="headerlink" title="log"></a>log</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">建立这个文件Pytest.ini</span><br><span class="line">[pytest]</span><br><span class="line">log_cli = <span class="number">1</span></span><br><span class="line">log_cli_level = info</span><br><span class="line">log_cli_format = %(asctime)s [%(levelname)<span class="number">8</span>s] %(message)s (%(filename)s:%(lineno)s)</span><br><span class="line">log_cli_date_format=%Y-%m-%d %H:%M:%S</span><br><span class="line">写测试用例————log.info()</span><br><span class="line">用: pytest pytest_testlog.py -o log.cli=true -o log._cli_level=INFO</span><br><span class="line">-o是覆盖配置的内容</span><br></pre></td></tr></table></figure>

<h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> pytest-html ⽣成可视化报告,--self-contained-html(把css样式合并到html)</span></span><br><span class="line">pytest -v -s --html=report.html --self-contained-html</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> pytest-assume 多条断⾔有失败也都运⾏</span></span><br><span class="line">pytest.assume(1==4)</span><br><span class="line">pytest.assume(2==4)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> pytest-rerunfailures 失败重跑 —reruns n, n是重复次数</span></span><br><span class="line">pytest --reruns 5  test_sort_demo.py</span><br><span class="line"></span><br><span class="line">pytest-allure #⾼⼤上精美报告</span><br><span class="line"></span><br><span class="line">pytest-xdist #并⾏运⾏多个测试 pytest -n 2 在2个cpu上运⾏测试 —looponfail标志，它将⾃动重新运⾏你的失败测试</span><br><span class="line">pytest -n 3</span><br><span class="line"></span><br><span class="line">Pytest-sugar # 改变pytest的默认外观，增加进度条，安装后即可</span><br><span class="line"></span><br><span class="line">Pytest-picked # 运⾏基于你已修改但尚未提交给git的代码的测试。</span><br><span class="line"></span><br><span class="line">Pytest-instafail # 修改默认⾏为，以⽴即显⽰失败和错误，⽽不是等到pytest完成每个测试运⾏。</span><br><span class="line"></span><br><span class="line">Pytest-tldr # 简化man指令帮助文档</span><br><span class="line"></span><br><span class="line">Pytest-django # 开发web</span><br><span class="line"></span><br><span class="line">Pytest-selenium # pytest 提供运⾏⽀持selenium为基础</span><br><span class="line"></span><br><span class="line">pytest-ordering # 顺序编排</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fixtures:为了测试⽤例的执行，⽽初始化⼀些数据和方法</span></span><br><span class="line"><span class="comment"># 名字调用,yield 之前相当于setup;yield 之后相当于tearDown</span></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loginandlogout</span>():</span></span><br><span class="line">	print(<span class="string">&#x27;do login action\n&#x27;</span>)</span><br><span class="line">	<span class="keyword">yield</span></span><br><span class="line">	print(<span class="string">&quot;do logout action&quot;</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestSample</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">test_answer</span>(<span class="params">self,loginandlogout</span>):</span></span><br><span class="line">		...</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">test_answer2</span>(<span class="params">self,loginandlogout</span>):</span></span><br><span class="line">    	...</span><br><span class="line"><span class="comment"># decorator调用</span></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loginandlogout</span>():</span></span><br><span class="line">	print(<span class="string">&#x27;do login action\n&#x27;</span>)</span><br><span class="line">	<span class="keyword">yield</span></span><br><span class="line">	print(<span class="string">&quot;do logout action&quot;</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestSample</span>:</span></span><br><span class="line"><span class="meta">	@pytest.mark.usefixtures(&#x27;loginandlogout&#x27;)</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">test_answer</span>(<span class="params">self</span>):</span></span><br><span class="line">		...</span><br><span class="line"><span class="comment"># autouse,Fixture scope(module,session,class,package)</span></span><br><span class="line"><span class="meta">@pytest.fixture(scope=&#x27;module&#x27;,autouse=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loginandlogout</span>():</span></span><br><span class="line">	print(<span class="string">&#x27;do login action\n&#x27;</span>)</span><br><span class="line">	<span class="keyword">yield</span></span><br><span class="line">	print(<span class="string">&quot;do logout action\n&quot;</span>)</span><br><span class="line"><span class="meta">@pytest.fixture(scope=&#x27;class&#x27;,autouse=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clickhome</span>():</span></span><br><span class="line">	print(<span class="string">&#x27;click home button\n&#x27;</span>)</span><br><span class="line">	<span class="keyword">yield</span></span><br><span class="line">	print(<span class="string">&quot;end click home link\n&quot;</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestSample</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">test_answer</span>(<span class="params">self</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">test_answer2</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestSampleTwo</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">test_two_answer</span>(<span class="params">self</span>):</span></span><br><span class="line"><span class="comment"># 带参数传递</span></span><br><span class="line"><span class="meta">@pytest.fixture(params=[1, 2, 3, &#x27;bq&#x27;])</span></span><br><span class="line"><span class="comment"># mark.parametrize参数化</span></span><br><span class="line"><span class="meta">@pytest.mark.parametrize()</span></span><br><span class="line"><span class="comment"># 参数化和数据驱动</span></span><br><span class="line"><span class="meta">@pytest.mark.parametrize(“login_r”,test_user_data, indirect=True) indeirect=True是把login_r当作函数去执⾏</span></span><br><span class="line"><span class="comment"># mark中的skip与xfail</span></span><br><span class="line"><span class="comment"># 跳过这个测试⽤例，可以加条件skipif，在满⾜某些条件下才希望通过，否则跳过这个测试。</span></span><br><span class="line"><span class="meta">@pytest.mark.skip</span></span><br><span class="line"><span class="comment"># 测试通过时尽管预计会失败（标记为pytest.mark.xfail）,它是⼀个xpass,将在测试摘要中报告。</span></span><br><span class="line"><span class="meta">@pytest.mark.xfail</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Conftest.py:定义共享的fixture,一般放在testcases目录下，每个子目录下的conftest.py中的fixture优先</span></span><br></pre></td></tr></table></figure>

<h3 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h3><h4 id="获取用例执行结果处理用例依赖"><a href="#获取用例执行结果处理用例依赖" class="headerlink" title="获取用例执行结果处理用例依赖"></a>获取用例执行结果处理用例依赖</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># conftest.py</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 定义一个类，来存储用例执行失败的结果</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Falied</span>:</span></span><br><span class="line">    skip = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@pytest.hookimpl(hookwrapper=True, tryfirst=True)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pytest_runtest_makereport</span>():</span></span><br><span class="line">    result = <span class="keyword">yield</span></span><br><span class="line">    report = result.get_result()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 当前用例名</span></span><br><span class="line">    case_name = report.nodeid.split(<span class="string">&#x27;::&#x27;</span>)[<span class="number">-1</span>]</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 当某个用例失败时(setup失败也算)或被跳过时，将这个用例的执行结果存储在 Failed 类中</span></span><br><span class="line">    <span class="keyword">if</span> report.when <span class="keyword">in</span> (<span class="string">&#x27;setup&#x27;</span>, <span class="string">&#x27;call&#x27;</span>) <span class="keyword">and</span> report.outcome <span class="keyword">in</span> (<span class="string">&#x27;failed&#x27;</span>, <span class="string">&#x27;skipped&#x27;</span>):</span><br><span class="line">        setattr(Falied, case_name, <span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pytest.main([<span class="string">&#x27;-s&#x27;</span>, <span class="string">&#x27;-q&#x27;</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">from</span> .conftest <span class="keyword">import</span> Falied</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDemoA</span>:</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_A_001</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 断言失败</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_A_002</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 从 Failed 获取 test_A_001 的执行结果</span></span><br><span class="line">        <span class="keyword">if</span> getattr(Falied, <span class="string">&#x27;test_A_001&#x27;</span>, <span class="literal">False</span>):</span><br><span class="line">            pytest.skip(<span class="string">&#x27;test_A_001 执行失败或被跳过，此用例跳过！&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_A_003</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h3 id="report"><a href="#report" class="headerlink" title="report"></a>report</h3><p>生成 JunitXML 格式的测试报告，命令 : –junitxml= path<br>生成 ResultLog 格式的测试报告，命令: –resultlog=report/log.txt<br>生成 Html 格式的测试报告，命令: –html=OutPuts/reports/report.html (相对路径)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest --html=report/html/report.html  testcase/test_new_outfit.py::TestNewOutfit::test_newoutfit_normal</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/bq/ae82201a.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/9df1423d.html">CentOS7根目录磁盘扩容</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-06-03</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Linux/">Linux</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Linux/%E9%85%8D%E7%BD%AE/">配置</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Linux/">Linux</a></div></div><div class="post-content"><div class="main-content content"><h3 id="CentOS7根目录磁盘扩容"><a href="#CentOS7根目录磁盘扩容" class="headerlink" title="CentOS7根目录磁盘扩容"></a>CentOS7根目录磁盘扩容</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">[root@xycvt99 ~]# df -h</span><br><span class="line">Filesystem               Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/centos-root   17G   17G   12M 100% /</span><br><span class="line">devtmpfs                 8.0G     0  8.0G   0% /dev</span><br><span class="line">tmpfs                     16G  1.4G   15G   9% /dev/shm</span><br><span class="line">tmpfs                    8.1G  106M  7.9G   2% /run</span><br><span class="line">tmpfs                    8.1G     0  8.1G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sdb1                197G   52G  135G  28% /opt</span><br><span class="line">/dev/sda1               1014M  145M  870M  15% /boot</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/0</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/1009</span><br><span class="line">[root@xycvt99 ~]# sudo fuser -km /opt</span><br><span class="line">/opt:                 3261ce  3590ce  3863ce  4628ce  9801ce  9829  9835ce 11643ce 11695ce 12835 14394ce 14396ce 14399ce 14401ce 14406ce 14408ce 14412ce 14415ce 14417ce 14420ce 14422ce 14424ce 14426ce 14428ce 14430ce 14432ce 14436ce 14438ce 14441ce 14443ce 14445ce 14447ce 14464ce 14466ce 14468ce 14470ce 14474ce 14476ce 14478ce 14480ce 14482ce 14817ce 14819ce 14822ce 14824ce 14826ce 14829ce 14831ce 15012ce 15026ce 15040ce 15465ce 15846ce 15848ce 15854ce 15856ce 15858ce 15860ce 15862ce 15864ce 15866ce 15868ce 15870ce 15872ce 15878ce 15890ce 15940ce 16429 16435 16437 16439 16442 16444 16446 16448 16563 16587ce 16959ce 16964ce 16981ce 16996 17002 17004 17006 17008 17010 17012 17014 17029ce 17048ce 17065ce 17092ce 17095 17100ce 17106ce 17111ce 17115ce 17935ce 30058 30308ce 30345</span><br><span class="line">[root@xycvt99 ~]# umount /opt</span><br><span class="line">[root@xycvt99 ~]# df -h</span><br><span class="line">Filesystem               Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/centos-root   17G   17G  5.9M 100% /</span><br><span class="line">devtmpfs                 8.0G     0  8.0G   0% /dev</span><br><span class="line">tmpfs                     16G   52K   16G   1% /dev/shm</span><br><span class="line">tmpfs                    8.1G  106M  7.9G   2% /run</span><br><span class="line">tmpfs                    8.1G     0  8.1G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1               1014M  145M  870M  15% /boot</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/0</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/1009</span><br><span class="line"></span><br><span class="line">[root@xycvt99 ~]# fdisk -l</span><br><span class="line"></span><br><span class="line">Disk /dev/sdb: 214.7 GB, 214748364800 bytes, 419430400 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x2294ea50</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sdb1            2048   419430399   209714176   83  Linux</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x000c339c</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sda1   *        2048     2099199     1048576   83  Linux</span><br><span class="line">/dev/sda2         2099200    41943039    19921920   8e  Linux LVM</span><br><span class="line"></span><br><span class="line">Disk /dev/mapper/centos-root: 18.2 GB, 18249416704 bytes, 35643392 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/mapper/centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line"></span><br><span class="line">[root@xycvt99 ~]# lvextend -L +200G /dev/mapper/centos-root</span><br><span class="line">  Insufficient free space: 51200 extents needed, but only 0 available</span><br><span class="line">[root@xycvt99 ~]# vgs</span><br><span class="line">  VG     #PV #LV #SN Attr   VSize   VFree</span><br><span class="line">  centos   1   2   0 wz--n- &lt;19.00g    0 </span><br><span class="line">[root@xycvt99 ~]# vgextend centos /dev/sdb       </span><br><span class="line">  Device /dev/sdb excluded by a filter.</span><br><span class="line">[root@xycvt99 ~]# vgs</span><br><span class="line">  VG     #PV #LV #SN Attr   VSize   VFree</span><br><span class="line">  centos   1   2   0 wz--n- &lt;19.00g    0 </span><br><span class="line">[root@xycvt99 ~]# vgextend centos /dev/sdb1</span><br><span class="line">WARNING: ext4 signature detected on /dev/sdb1 at offset 1080. Wipe it? [y/n]: y</span><br><span class="line">  Wiping ext4 signature on /dev/sdb1.</span><br><span class="line">  Physical volume &quot;/dev/sdb1&quot; successfully created.</span><br><span class="line">  Volume group &quot;centos&quot; successfully extended</span><br><span class="line">[root@xycvt99 ~]# vgs</span><br><span class="line">  VG     #PV #LV #SN Attr   VSize   VFree   </span><br><span class="line">  centos   2   2   0 wz--n- 218.99g &lt;200.00g</span><br><span class="line">[root@xycvt99 ~]# lvextend -L +200G /dev/mapper/centos-root</span><br><span class="line">  Insufficient free space: 51200 extents needed, but only 51199 available</span><br><span class="line">[root@xycvt99 ~]# lvextend -L +199G /dev/mapper/centos-root   </span><br><span class="line">  Size of logical volume centos/root changed from &lt;17.00 GiB (4351 extents) to &lt;216.00 GiB (55295 extents).</span><br><span class="line">  Logical volume centos/root successfully resized.</span><br><span class="line">[root@xycvt99 ~]# df -h      </span><br><span class="line">Filesystem               Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/centos-root   17G   17G  6.6M 100% /</span><br><span class="line">devtmpfs                 8.0G     0  8.0G   0% /dev</span><br><span class="line">tmpfs                     16G   52K   16G   1% /dev/shm</span><br><span class="line">tmpfs                    8.1G  106M  7.9G   2% /run</span><br><span class="line">tmpfs                    8.1G     0  8.1G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1               1014M  145M  870M  15% /boot</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/0</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/1009</span><br><span class="line">[root@xycvt99 ~]# xfs_growfs /dev/mapper/centos-root</span><br><span class="line">meta-data=/dev/mapper/centos-root isize=512    agcount=4, agsize=1113856 blks</span><br><span class="line">         =                       sectsz=512   attr=2, projid32bit=1</span><br><span class="line">         =                       crc=1        finobt=0 spinodes=0</span><br><span class="line">data     =                       bsize=4096   blocks=4455424, imaxpct=25</span><br><span class="line">         =                       sunit=0      swidth=0 blks</span><br><span class="line">naming   =version 2              bsize=4096   ascii-ci=0 ftype=1</span><br><span class="line">log      =internal               bsize=4096   blocks=2560, version=2</span><br><span class="line">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none                   extsz=4096   blocks=0, rtextents=0</span><br><span class="line">data blocks changed from 4455424 to 56622080</span><br><span class="line">[root@xycvt99 ~]# df -h</span><br><span class="line">Filesystem               Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/mapper/centos-root  216G   17G  200G   8% /</span><br><span class="line">devtmpfs                 8.0G     0  8.0G   0% /dev</span><br><span class="line">tmpfs                     16G   52K   16G   1% /dev/shm</span><br><span class="line">tmpfs                    8.1G  106M  7.9G   2% /run</span><br><span class="line">tmpfs                    8.1G     0  8.1G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1               1014M  145M  870M  15% /boot</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/0</span><br><span class="line">tmpfs                    1.7G     0  1.7G   0% /run/user/1009</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/bq/9df1423d.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/efb6976f.html">Unittest使用</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-02-04</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/automation/">automation</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/python/">python</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Unittest/">Unittest</a></div></div><div class="post-content"><div class="main-content content"><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p>test cases、test suites、test fixtures、test runner</p>
<h3 id="编写规范"><a href="#编写规范" class="headerlink" title="编写规范"></a>编写规范</h3><p>• 测试模块首先 import unittest<br>• 测试类必须继承 unittest.TestCase<br>• 测试⽅方法必须以“test_”开头!<br>• 模块名字，类名没有要求</p>
<h3 id="执行规则"><a href="#执行规则" class="headerlink" title="执行规则"></a>执行规则</h3><p>基于测试⽅法级别的setUp, tearDown<br>• 执⾏每个测试方法的时候都会执行一次setUp 和tearDown<br>• 基于类级别的 setUpClass, tearDownClass<br>• 执⾏这个类里⾯的所有测试⽅法只有一次执行setup, tearDown<br>• 基于模块级别的 setUpModule，tearDownModule<br>• 执⾏此模块里的所有类⾥的测试⽅方法，只执行⼀次setup和teardown</p>
<h3 id="example"><a href="#example" class="headerlink" title="example"></a>example</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">封装测试套件运行某个目录下所有用例并出html报告</span><br><span class="line">importmport os,time</span><br><span class="line">case path = os.path.join(os.path.dirname(_ file_ ), <span class="string">&#x27;demo_unittest&#x27;</span>)</span><br><span class="line">report path = os.path.join(os.path,dirnane(_ file__ )， <span class="string">&#x27;report&#x27;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span> <span class="title">suite</span>( ):</span></span><br><span class="line">    suite = unittest.TestSuite( )</span><br><span class="line">    discover = unittestdefaultTestLoader.discover(casepath,pattern=<span class="string">&#x27;test*.py&#x27;</span>,top_level_dir=<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">print</span> (discover )</span><br><span class="line">    <span class="keyword">for</span> test suite <span class="keyword">in</span> discover:</span><br><span class="line">		<span class="keyword">for</span> test case <span class="keyword">in</span> test_suite :</span><br><span class="line">			suite.addTests (test_case )</span><br><span class="line">	<span class="keyword">return</span> suite</span><br><span class="line">now = time.strftime(<span class="string">&quot;%Y-%m-%d %H_%M_%S&quot;</span>, time.localtime())</span><br><span class="line">filename = report_path+<span class="string">&quot;/”+now+&quot;</span>_result.html<span class="string">&quot;</span></span><br><span class="line"><span class="string">with open(filename, &#x27;wb&#x27;) as fp:</span></span><br><span class="line"><span class="string">	runner = HTMLTestRunner(</span></span><br><span class="line"><span class="string">        stream=fp,</span></span><br><span class="line"><span class="string">        title=&#x27;接口测试报告&#x27;,</span></span><br><span class="line"><span class="string">        description=&#x27;搜索用例执行情况:&#x27;)</span></span><br><span class="line"><span class="string">    runner.run(create_suite())</span></span><br><span class="line"><span class="string">fp.close()</span></span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/bq/efb6976f.html#more">阅读全文</a></div><div class="recent-post-item"><i class="article-top"></i><a class="post-title" href="/bq/717c4b1d.html">requests测试http(s)接口</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2021-04-11</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/">Test</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Test/automation/">automation</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/http/">http</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/requests/">requests</a></div></div><div class="post-content"><div class="main-content content"><h3 id="httpbin服务"><a href="#httpbin服务" class="headerlink" title="httpbin服务"></a><strong>httpbin服务</strong></h3><p><a target="_blank" rel="noopener" href="http://www.httpbin.org/">http://www.httpbin.org/</a></p>
<p>一个使用 Python + Flask 编写的 HTTP HTTP Request &amp; Response Service。该服务主要用于测试 HTTP 库。你可以向他发送请求，然后他会按照指定的规则将你的请求返回。<br>httpbin支持HTTP/HTTPS，支持所有的HTTP动词，能模拟302跳转乃至302跳转的次数，还可以返回一个HTML文件或一个XML文件或一个图片文件（还支持指定返回图片的格式）。</p>
<h4 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull kennethreitz/httpbin</span><br><span class="line">docker run -p 8880:80 kennethreitz/httpbin</span><br></pre></td></tr></table></figure>

<h3 id="questions"><a href="#questions" class="headerlink" title="questions:"></a>questions:</h3><p>抓包数据认证问题：设置参数verify:false</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response = requests.get(url, params=params, headers=headers, verify=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

</div></div><a class="button-hover more" href="/bq/717c4b1d.html#more">阅读全文</a></div></div><div id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/">&lt;i class&#x3D;&quot;fas fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/">&lt;i class&#x3D;&quot;fas fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a></div></div></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fas fa-user"></i></span><span id="busuanzi_value_site_uv"></span><span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fas fa-eye"></i></span><span id="busuanzi_value_site_pv"></span><span></span></div><div class="copyright">&copy;2020 ～ 2022 By bq</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>